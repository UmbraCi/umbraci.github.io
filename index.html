<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Hexo</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/10/git-standard/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/10/git-standard/" itemprop="url">git团队协作使用规范</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-10T00:00:00+08:00">
                2020-03-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/" itemprop="url" rel="index">
                    <span itemprop="name">项目总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="为了便于团队项目能够更好的协同开发和维护，现制定以下git使用规范"><a href="#为了便于团队项目能够更好的协同开发和维护，现制定以下git使用规范" class="headerlink" title="为了便于团队项目能够更好的协同开发和维护，现制定以下git使用规范"></a>为了便于团队项目能够更好的协同开发和维护，现制定以下git使用规范</h1><h2 id="1-分支模型"><a href="#1-分支模型" class="headerlink" title="1. 分支模型"></a>1. 分支模型</h2><ul>
<li><code>master</code> - 最为稳定功能最为完整的随时可发布的代码;</li>
<li><code>dev</code> - 永远是功能最新最全的分支;</li>
<li><code>feature-[项目名称]</code> - 特性分支，某个功能点正在开发阶段的分支；</li>
<li><code>hotfix-[问题名称|bug编号]</code> - 修复线上代码的 bug的分支；</li>
</ul>
<h3 id="1-1-master-主分支"><a href="#1-1-master-主分支" class="headerlink" title="1.1 master 主分支"></a>1.1 master 主分支</h3><ul>
<li>master主分支始终保持稳定的可发布版本</li>
<li>只有项目组主程才拥有master主分支的管理权限（例如其他分支合并到master必须由主程操作）</li>
</ul>
<h3 id="1-2-dev-开发分支"><a href="#1-2-dev-开发分支" class="headerlink" title="1.2 dev 开发分支"></a>1.2 dev 开发分支</h3><ul>
<li>dev开发分支为不稳定版本，可能存在功能缺失，但已有的功能必须是完整的</li>
<li>原则上不允许直接在dev分支上进行功能开发，必须新建feature分支进行开发</li>
<li>dev分支是跑在测试环境的代码，给测试同学测试的</li>
</ul>
<h3 id="1-3-feature-功能名称-功能开发分支"><a href="#1-3-feature-功能名称-功能开发分支" class="headerlink" title="1.3 feature-[功能名称] 功能开发分支"></a>1.3 feature-[功能名称] 功能开发分支</h3><ul>
<li>从master主干创建，横线后跟功能名称，用于新功能开发，每天下班前push提交到远程</li>
<li>开发完成之后切回dev分支，拉取最新dev上最新代码，把feature分支合并到dev分支，这里会有冲突文件，需要对应项目的同事一起来合并冲突</li>
</ul>
<h3 id="1-4-hotfix-问题名称-bug编号-紧急热修复分支"><a href="#1-4-hotfix-问题名称-bug编号-紧急热修复分支" class="headerlink" title="1.4 hotfix-[问题名称 | bug编号] 紧急热修复分支"></a>1.4 hotfix-[问题名称 | bug编号] 紧急热修复分支</h3><ul>
<li>从master分支创建，横线后面跟上问题名称或者对应的bug编号，仅仅适用于<strong>生产线问题紧急修复</strong>！！！</li>
<li>修复完成，测试通过，合并到master和dev分支上，然后将此分支删除</li>
</ul>
<h2 id="2-commit规范"><a href="#2-commit规范" class="headerlink" title="2. commit规范"></a>2. commit规范</h2><h3 id="2-1-日志规范"><a href="#2-1-日志规范" class="headerlink" title="2.1 日志规范"></a>2.1 日志规范</h3><ul>
<li>功能点，列1，2，3</li>
<li>【研发：xx 测试：xx 项目经理：xxx】</li>
</ul>
<h3 id="2-2-提交频率"><a href="#2-2-提交频率" class="headerlink" title="2.2 提交频率"></a>2.2 提交频率</h3><ul>
<li>每天下班前必须提交feature分支，并且push到远程【防止出现电脑挂掉导致代码遗失的问题】</li>
<li>hotfix、feature分支尽量按照功能点或修复重构的问题及时commit（不要求push）【目的是防止一次commit提交大量改动，不便于后期排错】</li>
</ul>
<h2 id="3-开发流程"><a href="#3-开发流程" class="headerlink" title="3. 开发流程"></a>3. 开发流程</h2><ol>
<li><p>开发者pull master最新代码，拉取feature分支 统一命名风格：feature-[项目名称]</p>
</li>
<li><p>在feature分支上完成开发自测后，切换到dev分支，pull最新代码，把feature分支合并到dev分支，可能会出现冲突，和协作同事商量解决。</p>
<blockquote>
<p>注意，非简单的解决featue a 和test分支冲突，需要商量是feature a还是feature b需要调整代码，假若feature a需要调整代码，feature a调整代码，合并到dev分支。feature b 重新操作合并到dev分支。</p>
</blockquote>
</li>
<li><p>通知测试在测试分支测试，这个阶段不用关心发版进程，除非业务互相依赖。bug也在feature分支修改，修复完成后合并流程参考step2;</p>
</li>
<li><p>测试完全通过后，开发切换到master分支，pull最新代码，切换回feature分支，把master分支合并到feature分支（保证即将发布的代码没冲突），在gitlab提交合并请求，写上功能需求点，脚本等，指定项目管理员审核并且合并代码</p>
</li>
<li><p>管理员审核代码，处理（本次版本内）合并请求，打tag，发版，走线上验证流程。</p>
</li>
<li><p>完成功能开发。feature可以保留几周后统一清理</p>
</li>
</ol>
<h2 id="4-合并不同分支代码"><a href="#4-合并不同分支代码" class="headerlink" title="4. 合并不同分支代码"></a>4. 合并不同分支代码</h2><ul>
<li>保持commit记录清爽，比如上面的step2 ,把feature分支合并到dev分支，feature分支里面有很多每日的提交commit记录，这些记录只允许存在这个feature分支，不能合并到dev分支里面来</li>
</ul>
<p><code>正确做法</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git merge --squash feature<span class="_">-a</span>  </span><br><span class="line">git commit -m <span class="string">"合并feature-a分支代码到dev分支【研发：xxx 测试：xx 项目经理：xxx】"</span></span><br></pre></td></tr></table></figure>

<p><code>错误做法</code>(这样会把feature分支上的提交记录都混过来，导致commit记录混乱，不方便回滚代码)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge feature<span class="_">-a</span></span><br></pre></td></tr></table></figure>


<h4 id="git-提交合并请求，审核代码流程"><a href="#git-提交合并请求，审核代码流程" class="headerlink" title="git 提交合并请求，审核代码流程"></a>git 提交合并请求，审核代码流程</h4><p><img src="./git-standard/pull_request1.jpg" alt="合并请求"></p>
<p><img src="./git-standard/pull_request2.jpg" alt="创建合并请求"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/09/angular/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/09/angular/" itemprop="url">angular相关知识分享</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-03-09T00:00:00+08:00">
                2020-03-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/angular/" itemprop="url" rel="index">
                    <span itemprop="name">angular</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="angular相关知识分享"><a href="#angular相关知识分享" class="headerlink" title="angular相关知识分享"></a>angular相关知识分享</h3><hr>
<h4 id="resolve的使用"><a href="#resolve的使用" class="headerlink" title="resolve的使用"></a>resolve的使用</h4><h5 id="1、定义"><a href="#1、定义" class="headerlink" title="1、定义"></a>1、定义</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">官方定义：一个接口，某些类可以实现它以扮演一个数据提供者</span><br><span class="line">解释：类似于路由前置钩子，可以在路由加载到新页面的时候，将数据提前获取到，从而解决加载新页面白屏的问题，当然也可以使用loading或者骨架屏之类的解决方案</span><br></pre></td></tr></table></figure>

<h5 id="2、创建resolve"><a href="#2、创建resolve" class="headerlink" title="2、创建resolve"></a>2、创建resolve</h5><blockquote>
<p>index-resolve.service.ts</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Resolve &#125; <span class="keyword">from</span> <span class="string">'@angular/router'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">'rxjs'</span>;</span><br><span class="line">@Injectable(); <span class="comment">// 表明将这个服务标记为可注入的</span></span><br><span class="line"><span class="comment">// 导出一个实现resolve的类</span></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexResolveService</span> <span class="title">impolements</span> <span class="title">Resolve</span>&lt;<span class="title">any</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(</span><br><span class="line">  	private indexService: IndexService</span><br><span class="line">  )&#123;&#125;</span><br><span class="line">  <span class="comment">// 必须声明resolve方法，返回一个Observable</span></span><br><span class="line">  resolve(): Observable&lt;any&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.indexService.getData();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3、使用"><a href="#3、使用" class="headerlink" title="3、使用"></a>3、使用</h5><blockquote>
<p>Index-routing.module.ts</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; IndexResolveService &#125; <span class="keyword">from</span> <span class="string">'index-resolve.service.ts'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Routes, RouterModule &#125; <span class="keyword">from</span> <span class="string">'@angular/router'</span>;</span><br><span class="line"><span class="keyword">const</span> routes: Routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path:<span class="string">'xxx'</span>,</span><br><span class="line">    component: <span class="string">'xxx'</span>,</span><br><span class="line">    resolve: &#123; <span class="attr">indexData</span>: IndexResolveService &#125; <span class="comment">// 在路由中定义resolve属性</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [RouterModule.forChild(routes)],</span><br><span class="line">  exports: [RouterModule],</span><br><span class="line">  providers: [IndexResolveService] <span class="comment">// 注入服务</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Index.component.ts</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ActivatedRoute &#125; <span class="keyword">from</span> <span class="string">'@angular/router'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; OnInit &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(</span><br><span class="line">  	private route: ActivatedRoute // ActivatedRoute里面包含了路由的相关信息</span><br><span class="line">  )&#123;&#125;</span><br><span class="line">  ngOnInit(): <span class="keyword">void</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.route.data.subscribe(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">			<span class="keyword">const</span> data = res.indexData;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="4、操作符"><a href="#4、操作符" class="headerlink" title="4、操作符"></a>4、操作符</h5><ul>
<li><p>map</p>
<ol>
<li>定义</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">定义：将给定的project函数应用于源Observable发出的每个值，并将结果值作为Observable发出</span><br><span class="line">解释：跟array的map类似，可以对里面的值进行操作，然后以Observable发射出去</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>使用</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; map &#125; <span class="keyword">from</span> <span class="string">'rxjs/internal/operators'</span>;</span><br><span class="line"><span class="keyword">this</span>.indexService.getData().pipe(</span><br><span class="line">	map(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> xxx;</span><br><span class="line">  &#125;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p>forkJoin，zip</p>
<ol>
<li>定义</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">forkJoin定义：当所有可观测值完成时，从每个可观测值发出最后一个（最新）发出的值</span><br><span class="line">解释：类似promise.all，当所有的Observable流结束后，发出每个流的最后一个发出的值</span><br><span class="line"></span><br><span class="line">zip定义：当每个传入的可观测值第一次完毕时，合并流然后发出去，当每个传入的可观测值第二次、第三次...完毕时，又分别合并发出去</span><br><span class="line">解释：跟forkJoin一样都是合并流发出，但是zip会根据流本身发出的次数多次发出，而forkJoin仅发射最后一次</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>使用</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; forkJoin &#125; <span class="keyword">from</span> <span class="string">'rxjs'</span>;</span><br><span class="line">resolve(): Observable&lt;any&gt;&#123;</span><br><span class="line">  <span class="keyword">return</span> forkJoin([</span><br><span class="line">  	<span class="keyword">this</span>.indexService.getData(),</span><br><span class="line">    <span class="keyword">this</span>.indexService.getData1()</span><br><span class="line">  ])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>first，last，take</p>
<ol>
<li>定义</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fitst定义：只发出由源Observable所发出的值中第一个（或第一个满足条件的值）</span><br><span class="line">解释：在所有的流中取每个流第一次发出的值后结束</span><br><span class="line"></span><br><span class="line">last定义：只发出由源Observable所发出的值中最后一个</span><br><span class="line">解释：在所有的流中取每个流最后一次发出的值后结束</span><br><span class="line"></span><br><span class="line">take定义：只发出由源Observable所发出的值中最初发出的n个值</span><br><span class="line">解释：在所有的流中取每个流最初发出的n个值后结束</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>使用</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; first &#125; <span class="keyword">from</span> <span class="string">'rxjs/internal/operators'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; forkJoin &#125; <span class="keyword">from</span> <span class="string">'rxjs'</span>;</span><br><span class="line">resolve(): Observable&lt;any&gt;&#123;</span><br><span class="line">  <span class="keyword">return</span> forkJoin([</span><br><span class="line">  	<span class="keyword">this</span>.indexService.getData(),</span><br><span class="line">    <span class="keyword">this</span>.indexService.getData1()</span><br><span class="line">  ]).pipe(first())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h4 id="pipe的使用"><a href="#pipe的使用" class="headerlink" title="pipe的使用"></a>pipe的使用</h4><h5 id="1、创建pipe"><a href="#1、创建pipe" class="headerlink" title="1、创建pipe"></a>1、创建pipe</h5><blockquote>
<p>index.pipe.ts</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Pipe, PipeTransform &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line">@Pipe(&#123;</span><br><span class="line">  name: <span class="string">'index'</span>, <span class="comment">// 管道名称</span></span><br><span class="line">  pure: <span class="literal">true</span> <span class="comment">// 是否为纯管道，纯管道表示transform()方法只有在输入参数变化时才会调用，默认 true</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexPipe</span> <span class="title">implements</span> <span class="title">PipeTransform</span> </span>&#123;</span><br><span class="line">  transform(value, name) &#123;</span><br><span class="line">    <span class="comment">// value: 需要转换的值</span></span><br><span class="line">    <span class="comment">// name: 传入的参数</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> xxx;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义多个管道</span></span><br><span class="line">@Pipe(&#123;&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> ...</span></span><br></pre></td></tr></table></figure>

<h5 id="2、使用"><a href="#2、使用" class="headerlink" title="2、使用"></a>2、使用</h5><blockquote>
<p>index.module.ts</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; IndexPipe &#125; <span class="keyword">from</span> <span class="string">'index.pipe.ts'</span>;</span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  declarations: [IndexPipe], <span class="comment">// 声明管道</span></span><br><span class="line">  ...</span><br><span class="line">  exports: [IndexPipe] <span class="comment">// 导出管道</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>index.component.html</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  &#123;&#123;value | index : 'xxx'&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="ngrx的使用"><a href="#ngrx的使用" class="headerlink" title="ngrx的使用"></a>ngrx的使用</h4><h5 id="1、安装"><a href="#1、安装" class="headerlink" title="1、安装"></a>1、安装</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm i @ngrx/store -S</span><br><span class="line">yarn add @ngrx/store</span><br><span class="line">ng add @ngrx/store <span class="comment">// 如果使用angular-cli 6+ ，可以直接在项目中添加</span></span><br></pre></td></tr></table></figure>

<h5 id="2、创建动作action"><a href="#2、创建动作action" class="headerlink" title="2、创建动作action"></a>2、创建动作action</h5><blockquote>
<p>animal.action.ts</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createAction, props, Action &#125; <span class="keyword">from</span> <span class="string">'@ngrx/store'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Animal &#125; <span class="keyword">from</span> <span class="string">'animal.model.ts'</span>; <span class="comment">// &#123;name: string; age: number&#125;</span></span><br><span class="line"><span class="comment">// 方式A 8.x版本</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> CreateAnimal = createAction(</span><br><span class="line">	<span class="string">'[CreateAnimal Page] CreateAnimal'</span>, <span class="comment">// 通常[]里面声明使用动作的页面，后面声明触发动作的操作</span></span><br><span class="line">  props&lt;&#123;<span class="attr">animal</span>: Animal&#125;&gt;() 					<span class="comment">// 定义动作接收的参数</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> DeleteAnimal = createAction(</span><br><span class="line">	<span class="string">'[DeleteAnimal Page] DeleteAnimal'</span>,</span><br><span class="line">  props&lt;&#123;<span class="attr">animalLen</span>: number&#125;&gt;()</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式B 7.x版本</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> ActionTypes = &#123;</span><br><span class="line">  CREATE_ANIMAL: <span class="string">'[CreateAnimal Page] CreateAnimal'</span>,</span><br><span class="line">  DELETE_ANIMAL: <span class="string">'[DeleteAnimal Page] DeleteAnimal'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CreateAnimal</span> <span class="title">implememts</span> <span class="title">Action</span> </span>&#123;</span><br><span class="line">  readonly type = ActionTypes.CREATE_ANIMAL; <span class="comment">// type用来描述发生了什么动作</span></span><br><span class="line">  public animal: Animal;										 <span class="comment">// 定义动作接收的参数</span></span><br><span class="line">  <span class="keyword">constructor</span>() &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">DeleteAnimal</span> <span class="title">implememts</span> <span class="title">Action</span> </span>&#123;</span><br><span class="line">  readonly type = ActionTypes.DELETE_ANIMAL;</span><br><span class="line">  public animalLen: number;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> type actions = CreateAnimal | DeleteAnimal; <span class="comment">// 以别名的形式导出</span></span><br></pre></td></tr></table></figure>

<h5 id="3、创建减速器reducer"><a href="#3、创建减速器reducer" class="headerlink" title="3、创建减速器reducer"></a>3、创建减速器reducer</h5><blockquote>
<p>animal.reducer.ts</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createReducer &#125; <span class="keyword">from</span> <span class="string">'@ngrx/store'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; CreateAnimal, DeleteAnimal &#125; <span class="keyword">from</span> <span class="string">'animal.action.ts'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Animal &#125; <span class="keyword">from</span> <span class="string">'animal.model.ts'</span>; <span class="comment">// &#123;name: string; age: number&#125;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> AnimalActions <span class="keyword">from</span> <span class="string">'animal.action.ts'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initData: Animal = &#123;</span><br><span class="line">  name: <span class="string">'pig'</span>,</span><br><span class="line">  age: <span class="number">12</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 方式A</span></span><br><span class="line"><span class="keyword">const</span> _animalReducer = createReducer(</span><br><span class="line">  	[initData],</span><br><span class="line">    on(CreateAnimal, (state: Animal[], &#123; animal &#125;) =&gt; ([...state, animal])),</span><br><span class="line">    on(DeleteAnimal, (state: Animal[], &#123; animalLen &#125;) =&gt; &#123;</span><br><span class="line">      state.splice(animalLen, <span class="number">1</span>)</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">animalReducer</span>(<span class="params">state, action</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> _animalReducer(state, action);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式B</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">animalReducer</span>(<span class="params">state: Animal[] = [initData], action: AnimalActions.actions</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">switch</span>(action.type)&#123;</span><br><span class="line">    <span class="keyword">case</span> AnimalActions.ActionTypes.CREATE_ANIMAL:</span><br><span class="line">      <span class="keyword">return</span> [...state, action.animal];</span><br><span class="line">    <span class="keyword">case</span> AnimalActions.ActionTypes.DELETE_ANIMAL:</span><br><span class="line">      state.splice(action.animalLen, <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="4、创建state"><a href="#4、创建state" class="headerlink" title="4、创建state"></a>4、创建state</h5><blockquote>
<p>animal.state.ts</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Animal &#125; <span class="keyword">from</span> <span class="string">'animal.model.ts'</span>; <span class="comment">// &#123;name: string; age: number&#125;</span></span><br><span class="line"><span class="keyword">export</span> interface AnimalState &#123;</span><br><span class="line">  readonly animal: Animal[];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="5、使用"><a href="#5、使用" class="headerlink" title="5、使用"></a>5、使用</h5><blockquote>
<p>app.module.ts</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; StoreModule &#125; <span class="keyword">from</span> <span class="string">'@ngrx/store'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; animalReducer &#125; <span class="keyword">from</span> <span class="string">'animal.reducer.ts'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// StoreModule.forRoot(&#123;&#125;)用户全局注册</span></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">  imports: [</span><br><span class="line">    StoreModule.forRoot(&#123; <span class="attr">animal</span>: animalReducer &#125;)</span><br><span class="line">  ],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">AppModule</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>create.component.ts</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Obserbable &#125; <span class="keyword">from</span> <span class="string">'rxjs'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; OnInit &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Store &#125; <span class="keyword">from</span> <span class="string">'@ngrx/store'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Animal &#125; <span class="keyword">from</span> <span class="string">'animal.model.ts'</span>; <span class="comment">// &#123;name: string; age: number&#125;</span></span><br><span class="line"><span class="keyword">import</span> &#123; AnimalState &#125; <span class="keyword">from</span> <span class="string">'animal.state.ts'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> AnimalActions <span class="keyword">from</span> <span class="string">'animal.action.ts'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">CreateAnimalComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</span><br><span class="line">  animal: Observable&lt;Animal[]&gt;;</span><br><span class="line">  <span class="keyword">constructor</span>(</span><br><span class="line">  	private store: Store&lt;AnimalState&gt;</span><br><span class="line">  )&#123;</span><br><span class="line">    <span class="keyword">this</span>.animal = store.select(<span class="string">'animal'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">	createAnimal()&#123;</span><br><span class="line">    <span class="comment">// 以函数形式定义带的动作用法 方式A</span></span><br><span class="line">    <span class="keyword">this</span>.store.dispatch(CreateAnimal(&#123;</span><br><span class="line">      name: <span class="string">'cat'</span>,</span><br><span class="line">      age: <span class="number">12</span></span><br><span class="line">    &#125;))</span><br><span class="line">    <span class="comment">// 以class形式定义的动作用法 方式B</span></span><br><span class="line">    <span class="keyword">this</span>.store.dispatch(<span class="keyword">new</span> AnimalActions.CreateAnimal(&#123;</span><br><span class="line">      name: <span class="string">'cat'</span>,</span><br><span class="line">      age: <span class="number">12</span></span><br><span class="line">    &#125;))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/11/node-schedule/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/11/node-schedule/" itemprop="url">node-schedule定时任务</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-11T00:00:00+08:00">
                2019-12-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nestjs/" itemprop="url" rel="index">
                    <span itemprop="name">nestjs</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="内容概要"><a href="#内容概要" class="headerlink" title="内容概要"></a>内容概要</h3><ul>
<li>在实际开发项目中，会遇到很多定时任务的工作。比如：定时发送推送通知，定时更新某些数据等等<br>这是我们第一时间想到的就是可以写个定时器，来完成相应的需求，而在在node.js中可以使用node-schedule来完成定时任务<br>nestjs是一个node框架当然也可以使用node-schedule来完成定时任务。下面就用示例来说明一下node-schedule的用法.</li>
</ul>
<p>安装依赖<br>    npm install node-schedule</p>
<h3 id="开启一个定时任务"><a href="#开启一个定时任务" class="headerlink" title="开启一个定时任务"></a>开启一个定时任务</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schedule = <span class="built_in">require</span>(<span class="string">'node-schedule'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scheduleTask</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    schedule.scheduleJob(<span class="string">'30 * * * * *'</span>, ()=&gt;&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'scheduleTask:'</span> + <span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line">    &#125;); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scheduleTask();</span><br><span class="line"><span class="comment">// schedule.scheduleJob的回调函数中写入要执行的任务代码，一个定时器就完成了！传入的'30 * * * * *'带来的结果是每分钟的30秒时都会执行</span></span><br></pre></td></tr></table></figure>

<h3 id="定时任务中的通配符解释"><a href="#定时任务中的通配符解释" class="headerlink" title="定时任务中的通配符解释"></a>定时任务中的通配符解释</h3><pre><code>* * * * * *
┬ ┬ ┬ ┬ ┬ ┬
│ │ │ │ │  |
│ │ │ │ │ └ day of week (0 - 7) (0 or 7 is Sun)
│ │ │ │ └───── month (1 - 12)
│ │ │ └────────── day of month (1 - 31)
│ │ └─────────────── hour (0 - 23)
│ └──────────────────── minute (0 - 59)
└───────────────────────── second (0 - 59, OPTIONAL)</code></pre><p>6个占位符从左到右分别代表：秒、分、时、日、月、周几</p>
<p>每分钟的第30秒触发： ‘30 * * * * *’</p>
<p>每小时的1分30秒触发 ：’30 1 * * * *’</p>
<p>每天的凌晨1点1分30秒触发 ：’30 1 1 * * *’</p>
<p>每月的1日1点1分30秒触发 ：’30 1 1 1 * *’</p>
<p>每年的1月1日1点1分30秒触发 ：’30 1 1 1 1 *’</p>
<p>每周1的1点1分30秒触发 ：’30 1 1 * * 1’</p>
<h3 id="范围触发"><a href="#范围触发" class="headerlink" title="范围触发"></a>范围触发</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schedule = <span class="built_in">require</span>(<span class="string">'node-schedule'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scheduleTask</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    schedule.scheduleJob(<span class="string">'1-10 * * * * *'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'scheduleTask:'</span> + <span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line">    &#125;); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scheduleTask();</span><br><span class="line"><span class="comment">// 每分钟的1-10秒都会触发  其它占用符使用方法一样</span></span><br></pre></td></tr></table></figure>

<h3 id="递归规则定时器"><a href="#递归规则定时器" class="headerlink" title="递归规则定时器"></a>递归规则定时器</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schedule = <span class="built_in">require</span>(<span class="string">'node-schedule'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scheduleTask</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> rule = <span class="keyword">new</span> schedule.RecurrenceRule();</span><br><span class="line">    <span class="comment">// rule.dayOfWeek = 2;</span></span><br><span class="line">    <span class="comment">// rule.year = 2020; </span></span><br><span class="line">    <span class="comment">// rule.month = 3;</span></span><br><span class="line">    <span class="comment">// rule.dayOfMonth = 1;</span></span><br><span class="line">    <span class="comment">// rule.hour = 1;</span></span><br><span class="line">    <span class="comment">// rule.minute = 30;</span></span><br><span class="line">    rule.second = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    schedule.scheduleJob(rule, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">'scheduleTask:'</span> + <span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line">    &#125;);</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scheduleTask();</span><br><span class="line"><span class="comment">// 每分钟第60(0)秒时就会触发</span></span><br></pre></td></tr></table></figure>

<h3 id="对象文本语法定时器"><a href="#对象文本语法定时器" class="headerlink" title="对象文本语法定时器"></a>对象文本语法定时器</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schedule = <span class="built_in">require</span>(<span class="string">'node-schedule'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scheduleTask</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//dayOfWeek</span></span><br><span class="line">    <span class="comment">//month</span></span><br><span class="line">    <span class="comment">//dayOfMonth</span></span><br><span class="line">    <span class="comment">//hour</span></span><br><span class="line">    <span class="comment">//minute</span></span><br><span class="line">    <span class="comment">//second</span></span><br><span class="line">    schedule.scheduleJob(&#123;<span class="attr">hour</span>: <span class="number">17</span>, <span class="attr">minute</span>: <span class="number">0</span>, <span class="attr">dayOfWeek</span>: <span class="number">5</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'scheduleTask:'</span> + <span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line">    &#125;);</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scheduleTask();</span><br><span class="line"><span class="comment">// 每周五的下午17：00分触发</span></span><br></pre></td></tr></table></figure>
<h3 id="取消定时器"><a href="#取消定时器" class="headerlink" title="取消定时器"></a>取消定时器</h3><p>调用定时器对象的cancl方法即可</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schedule = <span class="built_in">require</span>(<span class="string">'node-schedule'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scheduleCancel</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> counter = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> j = schedule.scheduleJob(<span class="string">'* * * * * *'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'定时器触发次数：'</span> + counter);</span><br><span class="line">        counter++;</span><br><span class="line">        </span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'定时器取消'</span>)</span><br><span class="line">        j.cancel();   </span><br><span class="line">    &#125;, <span class="number">5000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scheduleCancel();</span><br><span class="line"><span class="comment">// 5000ms后取消则触发五次后将会取消</span></span><br></pre></td></tr></table></figure>

<h3 id="nestjs中使用定时器"><a href="#nestjs中使用定时器" class="headerlink" title="nestjs中使用定时器"></a>nestjs中使用定时器</h3><p>这里有这样一个需求，每周五的下午6点定时更新数据库中某些字段；<br>这里我们就可以实现一个接口用来更新数据库表字段，而关键就在于每周五的下午6点去更新，这时我们就可以启一个定时任务，定时调用接口达到定时更新的目的。<br>例如：<br>有接口 <a href="http://localhost:3000/photo/updateStatus" target="_blank" rel="noopener">http://localhost:3000/photo/updateStatus</a> 定时将数据库中数据删除(不建议删库，一般设置字段表示数据状态，更新该字段为指定值表示删除状态)</p>
<p>在main.ts引入并使用</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Logger &#125; <span class="keyword">from</span> <span class="string">'@nestjs/common'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; NestFactory, FastifyAdapter &#125; <span class="keyword">from</span> <span class="string">'@nestjs/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppModule &#125; <span class="keyword">from</span> <span class="string">'./app.module'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> cors <span class="keyword">from</span> <span class="string">'cors'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; join &#125; <span class="keyword">from</span> <span class="string">'path'</span>;</span><br><span class="line"><span class="keyword">import</span> fly <span class="keyword">from</span> <span class="string">'flyio'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// tslint:disable-next-line:no-var-requires</span></span><br><span class="line"><span class="keyword">const</span> schedule = <span class="built_in">require</span>(<span class="string">'node-schedule'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scheduleTask</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 定时任务</span></span><br><span class="line">    <span class="keyword">const</span> timing = schedule.scheduleJob(<span class="string">'0 0 0 * * *'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        Logger.log(<span class="string">'定时任务'</span>);</span><br><span class="line">        fly.get(<span class="string">'http://localhost:3000/photo/updateStatus'</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            Logger.log(<span class="built_in">JSON</span>.stringify(res.data));</span><br><span class="line">        &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">            Logger.log(<span class="built_in">JSON</span>.stringify(err));</span><br><span class="line">        &#125;); <span class="comment">// 定时任务更改数据</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">scheduleTask(); <span class="comment">// 开启定时任务</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">bootstrap</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> app = <span class="keyword">await</span> NestFactory.create(AppModule);</span><br><span class="line">    app.useStaticAssets(join(__dirname, <span class="string">'..'</span>, <span class="string">'public'</span>));</span><br><span class="line">    app.use(</span><br><span class="line">        cors(&#123;</span><br><span class="line">            credentials: <span class="literal">true</span>,</span><br><span class="line">        &#125;),</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">await</span> app.listen(<span class="number">3000</span>);</span><br><span class="line">&#125;</span><br><span class="line">bootstrap();</span><br></pre></td></tr></table></figure>

<h3 id="nest-schedule"><a href="#nest-schedule" class="headerlink" title="nest-schedule"></a>nest-schedule</h3><p><a href="http://npm.taobao.org/package/nest-schedule" target="_blank" rel="noopener">nest-schedule</a>是一个基于node-schedule实现的用于nest.js的任务库<br>…还未尝试使用</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/js-abbreviation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/js-abbreviation/" itemprop="url">js的一些常用简写操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-10T00:00:00+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/" itemprop="url" rel="index">
                    <span itemprop="name">项目总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="内容概要"><a href="#内容概要" class="headerlink" title="内容概要"></a>内容概要</h3><p>有助于大家更加熟练的运用 JavaScript 语言来进行开发工作 – 关于简写 大家一起慢慢补充0_0哦</p>
<h3 id="声明变量"><a href="#声明变量" class="headerlink" title="声明变量"></a>声明变量</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在函数开始之前，对变量进行赋值是一种很好的习惯。在申明多个变量时,我们可能会：</span></span><br><span class="line"><span class="keyword">let</span> x;</span><br><span class="line"><span class="keyword">let</span> y;</span><br><span class="line"><span class="keyword">let</span> z = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 简写为</span></span><br><span class="line"><span class="keyword">let</span> x, y, z=<span class="number">3</span>;</span><br></pre></td></tr></table></figure>
<h3 id="三目运算符"><a href="#三目运算符" class="headerlink" title="三目运算符"></a>三目运算符</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通常我们经常会写if...else..语句 例如</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> b;</span><br><span class="line"><span class="keyword">if</span> (a &gt; <span class="number">10</span>) &#123;</span><br><span class="line">    b = <span class="string">'greater than 10'</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    b = <span class="string">'less than 10'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 可简写为</span></span><br><span class="line"><span class="keyword">var</span> b = a &gt; <span class="number">10</span> ? <span class="string">'greater than 10'</span> : <span class="string">'less than 10'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="if-语句"><a href="#if-语句" class="headerlink" title="if 语句"></a>if 语句</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在使用 if 进行基本判断时，可以省略赋值运算符。</span></span><br><span class="line"><span class="keyword">if</span> (a === <span class="literal">true</span>) / <span class="keyword">if</span> (a === <span class="literal">undefined</span> || a === <span class="literal">null</span> || a === <span class="string">''</span> || a===<span class="number">0</span>) </span><br><span class="line"><span class="comment">// 可简写为</span></span><br><span class="line"><span class="keyword">if</span>( a ) / <span class="keyword">if</span>(!a)</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<h3 id="十进制数"><a href="#十进制数" class="headerlink" title="十进制数"></a>十进制数</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 可以使用科学计数法来代替较大的数据，如可以将 100000 简写为 1e5。</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">100000</span>;</span><br><span class="line"><span class="comment">// 可简写为</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">1e5</span>;</span><br></pre></td></tr></table></figure>
<h3 id="模板字符串"><a href="#模板字符串" class="headerlink" title="模板字符串"></a>模板字符串</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 过去我们习惯了使用“+”将多个变量转换为字符串</span></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">'http://'</span> + host + <span class="string">':'</span> + port + <span class="string">'/'</span> + path;</span><br><span class="line"><span class="comment">// ES6 提供了相应的方法，我们可以使用反引号和 $ &#123; &#125; 将变量合成一个字符串。</span></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">`http://<span class="subst">$&#123;host&#125;</span>:<span class="subst">$&#123;port&#125;</span>/<span class="subst">$&#123;path&#125;</span>`</span>;</span><br></pre></td></tr></table></figure>

<h3 id="未完待续，大家快来补充啊…"><a href="#未完待续，大家快来补充啊…" class="headerlink" title="未完待续，大家快来补充啊…"></a>未完待续，大家快来补充啊…</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/12/10/nest-one/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/12/10/nest-one/" itemprop="url">Nest.js项目入门实战(一)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-12-10T00:00:00+08:00">
                2019-12-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nestjs/" itemprop="url" rel="index">
                    <span itemprop="name">nestjs</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="内容概要"><a href="#内容概要" class="headerlink" title="内容概要"></a>内容概要</h3><ul>
<li>该篇主要介绍Nest.js项目的基础知识以及项目初始搭建,nest cli的使用,以及连接数据库实现一个简单的增删改查接口的项目示例</li>
</ul>
<h3 id="Nest-js简介"><a href="#Nest-js简介" class="headerlink" title="Nest.js简介"></a>Nest.js简介</h3><p>Nest是一套现代化的基于Node.js的强大的Web应用框架</p>
<p>Nest的核心概念是提供一种体系结构，它帮助开发人员实现层的最大分离，并在应用程序中增加抽象</p>
<blockquote>
<p>文档：<a href="https://nestjs.com/" target="_blank" rel="noopener">https://nestjs.com/</a><br>中文文档：<a href="https://docs.nestjs.cn/" target="_blank" rel="noopener">https://docs.nestjs.cn/</a><br>git地址：<a href="https://github.com/nestjs/nest" target="_blank" rel="noopener">https://github.com/nestjs/nest</a></p>
</blockquote>
<hr>
<h3 id="使用Nest-CLI创建项目"><a href="#使用Nest-CLI创建项目" class="headerlink" title="使用Nest CLI创建项目"></a>使用Nest CLI创建项目</h3><p>安装CLI &nbsp;&nbsp;&nbsp; <code>npm i -g @nestjs/cli</code><br>使用CLI新建项目 &nbsp;&nbsp;&nbsp; <code>nest new project-name</code></p>
<p>运行后会默认创建以下内容</p>
<pre><code>CREATE /nest-test-peoject/.prettierrc (51 bytes)
CREATE /nest-test-peoject/nest-cli.json (64 bytes)
CREATE /nest-test-peoject/package.json (1700 bytes)
CREATE /nest-test-peoject/README.md (3370 bytes)
CREATE /nest-test-peoject/tsconfig.build.json (97 bytes)
CREATE /nest-test-peoject/tsconfig.json (336 bytes)
CREATE /nest-test-peoject/tslint.json (426 bytes)
CREATE /nest-test-peoject/src/app.controller.spec.ts (617 bytes)
CREATE /nest-test-peoject/src/app.controller.ts (274 bytes)
CREATE /nest-test-peoject/src/app.module.ts (249 bytes)
CREATE /nest-test-peoject/src/app.service.ts (142 bytes)
CREATE /nest-test-peoject/src/main.ts (208 bytes)
CREATE /nest-test-peoject/test/app.e2e-spec.ts (561 bytes)
CREATE /nest-test-peoject/test/jest-e2e.json (183 bytes)</code></pre><p>这里为我们创建了一个根模块AppModule &nbsp;&nbsp;&nbsp; <code>main.ts</code>为项目启动入口文件</p>
<h3 id="Nest项目-基础知识"><a href="#Nest项目-基础知识" class="headerlink" title="Nest项目-基础知识"></a>Nest项目-基础知识</h3><ul>
<li><p>模块Module<br>  用于将代码拆分为独立的和可重用的模块，例如有一个用户信息模块，然后将该用户模块的控制器和服务集合进来，最后需要将用户模块导入到根Module使用。<br>每个Nest应用都有一个根模块，通常是 AppModule。根模块提供了用来启动应用的引导机制，可以包含很多功能模块。</p>
<br />

<p>  <strong>Module模块中@Module()装饰器接受一个对象</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td>providers</td>
<td align="center">由nest注入器实例化的服务，可以在这个模块之间共享</td>
</tr>
<tr>
<td>controller</td>
<td align="center">存放创建的一组控制器</td>
</tr>
<tr>
<td>imports</td>
<td align="center">导入此模块中所需的提供程序的模块列表</td>
</tr>
<tr>
<td>exports</td>
<td align="center">导出这个模块可以其他模块享用providers里的服务</td>
</tr>
</tbody></table>
</li>
<li><p>控制器Controller<br>  通俗来说就是路由Router，负责处理客户端传入的请求参数并向客户端返回响应数据，也可以理解是HTTP请求。nest.js提供许多http请求的装饰器，例如:方法参数装饰器@Param,@Body(),@Query;方法装饰器@Post(),@Get,@Put()等。</p>
</li>
<li><p>服务与依赖注入 Provider &amp; Dependency injection<br>  在这里处理所有请求执行逻辑，在控制器中通过constructor函数以依赖注入的方式实现。Controller负责处理Request及产生Response，而数据库存取或是业务逻辑通常写在Service class里。<br>  提供程序是 Nest的一个基本概念。许多基本的 Nest类可能被视为提供者 - service,repository, factory 等等。 他们都可以通过 constructor 注入依赖关系。 这意味着对象可以彼此创建各种关系，并且“连接”对象实例的功能在很大程度上可以委托给 Nest运行时系统。 提供者只是一个用 @Injectable()装饰器注释的类。</p>
</li>
<li><p>Middleware 中间件<br>  中间件是在路由处理程序之前调用的函数。中间件功能可以访问请求和响应对象，以及应用程序请求-响应周期中的下一个中间件功能。<br>  中间件函数可以执行以下任务:</p>
<ul>
<li>执行任何代码。</li>
<li>对请求和响应对象进行更改。</li>
<li>结束请求-响应周期。</li>
<li>调用堆栈中的下一个中间件函数。</li>
<li>如果当前的中间件函数没有结束请求-响应周期, 它必须调用 next() 将控制传递给下一个中间件函数。否则, 请求将被挂起。</li>
</ul>
</li>
<li><p>Exception filter 过滤器<br>  Nest 内置了全局异常处理层，一旦应用程序抛出异常，Nest 便会自动捕获这些异常并给出 JSON 形式的响应。<br>  未知类型的错误将会抛出以下错误</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;statusCode&quot;: 500,</span><br><span class="line">	&quot;message&quot;: &quot;Internal server error&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Pipe 管道<br>  管道是具有 @Injectable() 装饰器的类。管道应实现 PipeTransform 接口。<br>  管道有两个类型:<br>  转换：管道将输入数据转换为所需的数据输出<br>  验证：对输入数据进行验证，如果验证成功继续传递; 验证失败则抛出异常;</p>
</li>
<li><p>Guard 守卫<br>  守卫可以做权限认证，如果你没有权限可以拒绝你访问这个路由，默认返回403错误<br>  守卫是用@Injectable()装饰器注释的类。应该实现CanActivate接口，具体代码在canActivate方法实现，返回一个布尔值，true就表示有权限，false抛出异常403错误。<br>  使用：<br>  直接@UseGuards()装饰器里面使用，作用当前控制器路由所有的请求参数 从 @nestjs/common 包导入。<br>  在全局注册使用内置实例方法useGlobalGuards，作用整个项目。</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const app &#x3D; await NestFactory.create(AppModule);</span><br><span class="line">app.useGlobalGuards(new Guard());</span><br></pre></td></tr></table></figure></li>
<li><p>Interceptor 拦截器<br>  拦截器可以做很多功能，比如缓存处理，响应数据转换，异常捕获转换，响应超时跑错，打印请求响应日志。<br>  设置拦截器：为了设置拦截器, 我们使用从 @nestjs/common 包导入的 @UseInterceptors() 装饰器。与守卫一样, 拦截器可以是控制器范围内的, 方法范围内的或者全局范围内的。</p>
</li>
</ul>
<p><font color='red'> 以上内容nestjs文档都有详细描述具体可以<a href="https://docs.nestjs.cn/" target="_blank" rel="noopener">前往阅读</a></font></p>
<h3 id="Nest项目-连接数据库"><a href="#Nest项目-连接数据库" class="headerlink" title="Nest项目-连接数据库"></a>Nest项目-连接数据库</h3><ul>
<li>Nest 与数据库无关，可以轻松地与任何 SQL 或 NoSQL 数据库集成。我们可以直接使用任何通用的 Node.js 数据库集成库或 ORM ，例如 <a href="https://sequelize.org/" target="_blank" rel="noopener">Sequelize (recipe)</a>,<a href="https://typeorm.io/#/" target="_blank" rel="noopener">TypeORM</a> ，以在更高的抽象级别上进行操作。Nest 使用TypeORM是因为它是 TypeScript 中最成熟的对象关系映射器( ORM )。因为它是用 TypeScript 编写的，所以可以很好地与 Nest 框架集成。这里我们连接操作mysql数据库。<br>安装typeorm 和 mysql  <code>npm install --save @nestjs/typeorm typeorm mysql</code><br>将<code>TypeOrmModule</code>导入<code>AppModule</code>。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Module &#125; <span class="keyword">from</span> <span class="string">'@nestjs/common'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TypeOrmModule &#125; <span class="keyword">from</span> <span class="string">'@nestjs/typeorm'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span>(&#123;</span><br><span class="line">imports: [</span><br><span class="line">	TypeOrmModule.forRoot(&#123;</span><br><span class="line">	<span class="keyword">type</span>: <span class="string">'mysql'</span>, <span class="comment">// 数据库类型。你必须指定要使用的数据库引擎。该值可以是"mysql"，"postgres"，"mariadb"，"sqlite"，"cordova"，"nativescript"，"oracle"，"mssql"，"mongodb"，"sqljs"，"react-native"。此选项是必需的。</span></span><br><span class="line">	name:<span class="string">''</span>, <span class="comment">// 连接名。 在使用 getConnection(name: string) 或 ConnectionManager.get(name: string)时候需要用到。不同连接的连接名称不能相同，它们都必须是唯一的。如果没有给出连接名称，那么它将被设置为"default"。</span></span><br><span class="line">	host: <span class="string">'localhost'</span>, <span class="comment">// 数据库 host</span></span><br><span class="line">	port: <span class="number">3306</span>, <span class="comment">// 数据库端口。mysql 默认的端口是3306.</span></span><br><span class="line">	username: <span class="string">'root'</span>, <span class="comment">// 数据库用户名</span></span><br><span class="line">	password: <span class="string">'root'</span>, <span class="comment">// 数据库密码</span></span><br><span class="line">	database: <span class="string">'test'</span>, <span class="comment">// 数据库名</span></span><br><span class="line">	entities: [],<span class="comment">//  要加载并用于此连接的实体。接受要加载的实体类和目录路径。目录支持 glob 模式。示例：entities: [ "entity/*.js", "modules/**/entity/*.js"]。</span></span><br><span class="line">	synchronize: <span class="literal">true</span>,<span class="comment">// 指示是否在每次应用程序启动时自动创建数据库架构。 请注意此选项，不要在生产环境中使用它，否则将丢失所有生产数据。但是此选项在调试和开发期间非常有用。</span></span><br><span class="line">	charset:<span class="string">'utf8mb4'</span>, <span class="comment">// 连接的字符集</span></span><br><span class="line">	timezone: <span class="string">'+0800'</span>, <span class="comment">// MySQL 服务器上配置的时区。这用于将服务器日期/时间值强制转换为 JavaScript Date 对象</span></span><br><span class="line">	logging: <span class="literal">true</span>, <span class="comment">// 指示是否启用日志记录。如果设置为true，则将启用查询和错误日志记录。</span></span><br><span class="line">	connectTimeout:<span class="string">'10000'</span>, <span class="comment">// 在连接到 MySQL 服务器期间发生超时之前的毫秒数。 （默认值：10000）</span></span><br><span class="line">	...</span><br><span class="line">	&#125;),</span><br><span class="line">],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>forRoot() 方法接受与来自 TypeORM包的 createConnection() 相同的配置对象。另外，我们可以创建 ormconfig.json ，而不是将配置对象传递给 forRoot()。<br>一旦完成，TypeORM 连接和 EntityManager 对象就可以在整个项目中注入(不需要导入任何模块)</p>
<ul>
<li>存储库模式<br>  TypeORM 支持存储库设计模式，因此每个实体都有自己的存储库。可以从数据库连接获得这些存储库。<br>  需要使用官方TypeORM文档中的  entity 实体</li>
</ul>
<h3 id="Nest项目-创建一个PhotoModule"><a href="#Nest项目-创建一个PhotoModule" class="headerlink" title="Nest项目-创建一个PhotoModule"></a>Nest项目-创建一个PhotoModule</h3><p>上面已经在AppModule注入了TypeOrmModule并配置数据库信息，现在我们配置TypeOrmModule.forRoot()中的entities为(glob 模式匹配目录文件)</p>
<pre><code>entities:[__dirname + &apos;/**/*.entity{.ts,.js}&apos;]</code></pre><p>方便我们在文件中创建entity文件，其中<code>__dirname</code> 表示的是当前文件所在目录  <code>**</code>匹配任意数量的字符包括空字符和路径分隔符 <code>*</code>匹配任意数量的字符包括空字符<br>接下来使用<code>nest g mo photo</code>创建PhotoModule，该命令将在src目录下创建了photo文件目录并新建了PhotoModule文件自动注入到了AppModule</p>
<pre><code>nest g mo photo
CREATE /src/photo/photo.module.ts (82 bytes)
UPDATE /src/app.module.ts (1359 bytes)</code></pre><p>创建完成后AppModule如下</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Module &#125; <span class="keyword">from</span> <span class="string">'@nestjs/common'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppController &#125; <span class="keyword">from</span> <span class="string">'./app.controller'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppService &#125; <span class="keyword">from</span> <span class="string">'./app.service'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Connection &#125; <span class="keyword">from</span> <span class="string">'typeorm'</span>;	</span><br><span class="line"><span class="keyword">import</span> &#123; TypeOrmModule &#125; <span class="keyword">from</span> <span class="string">'@nestjs/typeorm'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; PhotoModule &#125; <span class="keyword">from</span> <span class="string">'./photo/photo.module'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span>(&#123;</span><br><span class="line">  imports: [</span><br><span class="line">    TypeOrmModule.forRoot(&#123;</span><br><span class="line">        <span class="keyword">type</span>: <span class="string">'mysql'</span>,</span><br><span class="line">        host: <span class="string">'192.168.1.6'</span>,</span><br><span class="line">        port: <span class="number">3306</span>,</span><br><span class="line">        username: <span class="string">'root'</span>,</span><br><span class="line">        password: <span class="string">'xxxx'</span>,</span><br><span class="line">        database: <span class="string">'xxxx'</span>,</span><br><span class="line">        entities: [__dirname + <span class="string">'/**/*.entity&#123;.ts,.js&#125;'</span>],</span><br><span class="line">        synchronize: <span class="literal">true</span>,</span><br><span class="line">        timezone: <span class="string">'+0800'</span>,</span><br><span class="line">        logging: <span class="literal">true</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    PhotoModule,</span><br><span class="line">  ],</span><br><span class="line">  controllers: [AppController],</span><br><span class="line">  providers: [</span><br><span class="line">      AppService</span><br><span class="line">    ],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule &#123;</span><br><span class="line">	<span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> readonly connection: Connection</span>) &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来我们依次创建PhotoController和PhotoService</p>
<pre><code>nest g co photo
CREATE /src/photo/photo.controller.spec.ts (486 bytes)
CREATE /src/photo/photo.controller.ts (99 bytes)
UPDATE /src/photo/photo.module.ts (170 bytes)

nest g s photo
CREATE /src/photo/photo.service.spec.ts (453 bytes)
CREATE /src/photo/photo.service.ts (89 bytes)
UPDATE /src/photo/photo.module.ts (247 bytes)</code></pre><p>一般的我们将entity文件放在他们的域中, 放在相应的模块目录中。当然也可以在src目录下新建entities目录将entity文件放在该目录下管理。</p>
<ul>
<li>创建photo实体(photo.entity.ts)<br>实体是一个映射到数据库表（或使用 MongoDB 时的集合）的类。 你可以通过定义一个新类来创建一个实体，并用@Entity()来标记：<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Entity, Column, PrimaryGeneratedColumn &#125; <span class="keyword">from</span> <span class="string">'typeorm'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Entity</span>(<span class="string">'photo'</span>) <span class="comment">// 实体名称 对应数据库表名</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> Photo &#123;</span><br><span class="line"><span class="meta">@PrimaryGeneratedColumn</span>(&#123;comment: <span class="string">'照片表'</span>&#125;)</span><br><span class="line">id: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Column</span>(&#123; nullable: <span class="literal">true</span>, length: <span class="number">30</span>, comment: <span class="string">'照片名称'</span> &#125;)</span><br><span class="line">name: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Column</span>(&#123; nullable: <span class="literal">false</span>, <span class="keyword">default</span>:<span class="number">0</span>, comment: <span class="string">'该条记录状态 0正常 1删除'</span> &#125;)</span><br><span class="line">status: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Column</span>(&#123; nullable: <span class="literal">true</span>, <span class="keyword">type</span>: <span class="string">'datetime'</span>, comment: <span class="string">'该条记录创建时间'</span> &#125;)</span><br><span class="line">create_time: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Column</span>(&#123; nullable: <span class="literal">true</span>, length: <span class="number">255</span>, comment: <span class="string">'照片资源链接'</span> &#125;)</span><br><span class="line">url: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// orm配置中若synchronize为true则会在数据库自动执行创建表sql 创建photo表</span></span><br><span class="line">CREATE TABLE <span class="string">`photo`</span> (</span><br><span class="line">	<span class="string">`id`</span> int(<span class="number">11</span>) NOT NULL AUTO_INCREMENT COMMENT <span class="string">'照片表'</span>,</span><br><span class="line">	<span class="string">`name`</span> varchar(<span class="number">30</span>) COLLATE utf8mb4_general_ci DEFAULT NULL COMMENT <span class="string">'照片名称'</span>,</span><br><span class="line">	<span class="string">`status`</span> int(<span class="number">11</span>) NOT NULL DEFAULT <span class="string">'0'</span> COMMENT <span class="string">'该条记录状态 0正常 1删除'</span>,</span><br><span class="line">	<span class="string">`create_time`</span> datetime DEFAULT NULL COMMENT <span class="string">'该条记录创建时间'</span>,</span><br><span class="line">	<span class="string">`url`</span> varchar(<span class="number">255</span>) COLLATE utf8mb4_general_ci DEFAULT NULL COMMENT <span class="string">'照片资源链接'</span>,</span><br><span class="line">	PRIMARY KEY (<span class="string">`id`</span>)</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><font color='red'> synchronize: true,指示是否在每次应用程序启动时自动创建数据库架构。<br>请注意此选项，不要在生产环境中使用它，否则将丢失所有生产数据。但是此选项在调试和开发期间非常有用。</font></p>
<p><a href="https://typeorm.io/#/entities" target="_blank" rel="noopener">实体列属性等相关配置具体可参考typeOrm中实体</a></p>
<h3 id="Nest项目-PhotoController和PhotoService"><a href="#Nest项目-PhotoController和PhotoService" class="headerlink" title="Nest项目-PhotoController和PhotoService"></a>Nest项目-PhotoController和PhotoService</h3><p>接下来我们在PhotoController中创建几个方法用来接收客户端传入的请求参数并向客户端返回响应数据</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Controller, Get, Post, Patch, Body, Query &#125; <span class="keyword">from</span> <span class="string">'@nestjs/common'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; PhotoService &#125; <span class="keyword">from</span> <span class="string">'./photo.service'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span>(<span class="string">'photo'</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> PhotoController &#123;</span><br><span class="line">    <span class="comment">// 宣告变量，型別为PhotoService</span></span><br><span class="line">    <span class="comment">// private readonly photoService:PhotoService;</span></span><br><span class="line">    <span class="comment">// 建立PhotoController实例，一并建立PhotoService实例</span></span><br><span class="line">    <span class="comment">// constructor() &#123; this.photoService= new PhotoService(); &#125; </span></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> readonly photoService: PhotoService</span>) &#123; &#125; <span class="comment">// 将PhotoService注入到PhotoController</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建相片记录</span></span><br><span class="line"><span class="comment">     * @param body</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Post</span>() <span class="comment">// 请求方法装饰器</span></span><br><span class="line">    <span class="keyword">async</span> createPhoto(<span class="meta">@Body</span>() body): <span class="built_in">Promise</span>&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> <span class="keyword">this</span>.photoService.createPhoto(body);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除相片记录</span></span><br><span class="line"><span class="comment">     * @param body</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Patch</span>()</span><br><span class="line">    <span class="keyword">async</span> deletePhoto(<span class="meta">@Body</span>() body): <span class="built_in">Promise</span>&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> <span class="keyword">this</span>.photoService.deletePhoto(body);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 编辑相片记录内容</span></span><br><span class="line"><span class="comment">     * @param body</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Patch</span>()</span><br><span class="line">    <span class="keyword">async</span> updatePhoto(<span class="meta">@Body</span>() body): <span class="built_in">Promise</span>&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> <span class="keyword">this</span>.photoService.updatePhoto(body);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取相片列表</span></span><br><span class="line"><span class="comment">     * @param query</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Get</span>()</span><br><span class="line">    <span class="keyword">async</span> getPhotos(<span class="meta">@Query</span>() query): <span class="built_in">Promise</span>&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> <span class="keyword">this</span>.photoService.getPhotos(query);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应的 我们需要在PhotoService中写上对应的方法处理所有请求执行逻辑</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">'@nestjs/common'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Photo &#125; <span class="keyword">from</span> <span class="string">'../entities/photo.entity'</span>; <span class="comment">// 引入实体文件</span></span><br><span class="line"><span class="keyword">import</span> &#123; InjectRepository &#125; <span class="keyword">from</span> <span class="string">'@nestjs/typeorm'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Repository, getRepository &#125; <span class="keyword">from</span> <span class="string">'typeorm'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> PhotoService &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">        <span class="meta">@InjectRepository</span>(Photo)</span></span><br><span class="line"><span class="params">        <span class="keyword">private</span> readonly photoRepository: Repository&lt;Photo&gt;, <span class="comment">// Photo存储库</span></span></span><br><span class="line"><span class="params">    </span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建相片记录</span></span><br><span class="line"><span class="comment">     * @param body</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">async</span> createPhoto(body): <span class="built_in">Promise</span>&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> newPhoto = <span class="keyword">new</span> Photo();</span><br><span class="line">        newPhoto.create_time = body.create_time;</span><br><span class="line">        newPhoto.name = body.name;</span><br><span class="line">        <span class="comment">// newPhoto.status = body.status;</span></span><br><span class="line">        newPhoto.url = body.url;</span><br><span class="line">        <span class="keyword">const</span> newOrderRes = <span class="keyword">await</span> <span class="keyword">this</span>.photoRepository.save(newPhoto);</span><br><span class="line">        <span class="keyword">return</span> &#123; message: <span class="string">'创建成功'</span>, code: <span class="string">'01'</span>, content: newOrderRes &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除相片记录</span></span><br><span class="line"><span class="comment">     * @param body</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">async</span> deletePhoto(body): <span class="built_in">Promise</span>&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">        <span class="comment">// await this.photoRepository.delete(body.id);</span></span><br><span class="line">        <span class="comment">// await this.photoRepository.delete( &#123; name:body.name&#125;);</span></span><br><span class="line">        <span class="keyword">const</span> needDelete = <span class="keyword">await</span> <span class="keyword">this</span>.photoRepository.findOne(body.id);</span><br><span class="line">        <span class="keyword">await</span> getRepository(Photo)</span><br><span class="line">            .createQueryBuilder(<span class="string">'Photo'</span>)</span><br><span class="line">            .update(needDelete)</span><br><span class="line">            .where(<span class="string">'id = :id'</span>, &#123; id: body.id &#125;)</span><br><span class="line">            .set(&#123; status: <span class="number">1</span> &#125;)</span><br><span class="line">            .execute();</span><br><span class="line">            <span class="keyword">return</span> &#123; message: <span class="string">'删除成功'</span>, code: <span class="string">'01'</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 编辑相片记录内容</span></span><br><span class="line"><span class="comment">     * @param body</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">async</span> updatePhoto(body): <span class="built_in">Promise</span>&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> needUpdate = <span class="keyword">await</span> <span class="keyword">this</span>.photoRepository.findOne(body.id);</span><br><span class="line">        <span class="keyword">const</span> updated = <span class="built_in">Object</span>.assign(needUpdate, body);</span><br><span class="line">        <span class="keyword">await</span> <span class="keyword">this</span>.photoRepository.update(body.id,updated);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取相片列表</span></span><br><span class="line"><span class="comment">     * @param query</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">async</span> getPhotos(query): <span class="built_in">Promise</span>&lt;<span class="built_in">any</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> qb = <span class="keyword">await</span> getRepository(Photo)</span><br><span class="line">            .createQueryBuilder(<span class="string">'p'</span>)</span><br><span class="line">            <span class="comment">// .select('p')</span></span><br><span class="line">            .select([<span class="string">'p.name'</span>,<span class="string">'p.url'</span>])</span><br><span class="line">            .skip((query.page - <span class="number">1</span>) * query.size)</span><br><span class="line">            .take(query.size)</span><br><span class="line">            .orderBy(&#123;</span><br><span class="line">                <span class="string">'p.create_time'</span>: <span class="string">'DESC'</span>,</span><br><span class="line">            &#125;);</span><br><span class="line">        qb.where(<span class="string">'1 = 1'</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">'name'</span> <span class="keyword">in</span> query) &#123;</span><br><span class="line">            qb.andWhere(<span class="string">'p.name = :name'</span>, &#123; name: query.name &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        qb.andWhere(<span class="string">'p.status != 1 '</span>);</span><br><span class="line">        <span class="keyword">const</span> list = <span class="keyword">await</span> qb.getMany();</span><br><span class="line">        <span class="keyword">const</span> total = <span class="keyword">await</span> qb.getCount();</span><br><span class="line">        <span class="keyword">return</span> &#123; list, total, message: <span class="string">'请求列表成功'</span>, code: <span class="string">'01'</span> &#125;;</span><br><span class="line">		</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在photoModule中</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Module &#125; <span class="keyword">from</span> <span class="string">'@nestjs/common'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; PhotoController &#125; <span class="keyword">from</span> <span class="string">'./photo.controller'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; PhotoService &#125; <span class="keyword">from</span> <span class="string">'./photo.service'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Photo &#125; <span class="keyword">from</span> <span class="string">'../entities/photo.entity'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TypeOrmModule &#125; <span class="keyword">from</span> <span class="string">'@nestjs/typeorm'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span>(&#123;</span><br><span class="line">  imports: [TypeOrmModule.forFeature([Photo])], <span class="comment">// 使用forFeature()方法来定义应在当前范围中注册的存储库。</span></span><br><span class="line">  controllers: [PhotoController],</span><br><span class="line">  providers: [PhotoService]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> PhotoModule &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>到这里一个PhotoModule模块就完成啦</p>
<p>使用<code>npm run start</code> 启动项目通过postman传入参数请求到 <a href="http://localhost/photo" target="_blank" rel="noopener">http://localhost/photo</a> 就可以访问接口完成增删改查</p>
<h3 id="PhotoService中处理数据"><a href="#PhotoService中处理数据" class="headerlink" title="PhotoService中处理数据"></a>PhotoService中处理数据</h3><p>在PhotoService中处理数据时用到了typeorm的api</p>
<ul>
<li>Repository ，Query Builder<br>  通过<code>this.photoRepository</code> <code>getRepository().createQueryBuilder()</code> <code>getConnection().createQueryBuilder()</code> 都可以操作想要操作的存储库</li>
</ul>
<h3 id="未完待续"><a href="#未完待续" class="headerlink" title="未完待续.."></a>未完待续..</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/29/js-es6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/29/js-es6/" itemprop="url">es6内容解读</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-29T00:00:00+08:00">
                2019-11-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/" itemprop="url" rel="index">
                    <span itemprop="name">项目总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="赋值解构"><a href="#赋值解构" class="headerlink" title="赋值解构"></a>赋值解构</h3><ul>
<li>赋值解构使得声明变量更简洁。特点是左边多个变量，右边是一个对象或数组。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解构出对象的属性</span></span><br><span class="line"><span class="keyword">let</span> aa = &#123;<span class="attr">b</span>: <span class="string">'11'</span>, <span class="attr">c</span>:<span class="string">'22'</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> &#123;b,c&#125; = aa;</span><br><span class="line"><span class="built_in">console</span>.log(b,c);	<span class="comment">// 11 22</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解构出对象的属性并重新取名</span></span><br><span class="line"><span class="keyword">let</span> a = &#123;<span class="attr">b</span>: <span class="string">'11'</span>, <span class="attr">c</span>:<span class="string">'22'</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> &#123;<span class="attr">b</span>: bb,<span class="attr">c</span>: cc&#125; = aa;</span><br><span class="line"><span class="built_in">console</span>.log(bb,cc);	<span class="comment">// 11 22</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解构数组</span></span><br><span class="line"><span class="keyword">let</span> [a, b] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(a,b);	<span class="comment">// 1 2</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解构时给变量默认值</span></span><br><span class="line">[a=<span class="number">5</span>, b=<span class="number">7</span>] = [<span class="number">1</span>];</span><br><span class="line"><span class="built_in">console</span>.log(a,b);	<span class="comment">// 1 7</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解构 rest的使用。...能解构剩余属性值</span></span><br><span class="line">[a, b, ...rest] = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>];</span><br><span class="line"><span class="built_in">console</span>.log(a,b,rest);	<span class="comment">// 10 20 [30, 40, 50]</span></span><br><span class="line">(&#123;a, b, ...rest&#125; = &#123;<span class="attr">a</span>: <span class="number">10</span>, <span class="attr">b</span>: <span class="number">20</span>, <span class="attr">c</span>: <span class="number">30</span>, <span class="attr">d</span>: <span class="number">40</span>&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(a,b,rest);	<span class="comment">// 10 20 &#123;c: 30, d: 40&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Generator生成器"><a href="#Generator生成器" class="headerlink" title="Generator生成器"></a>Generator生成器</h3><ul>
<li>可以理解为一个状态机，封装了多个内部状态，每次调用就遍历并执行一个状态。这样就可以使得多个函数共同配合完成某个任务。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">helloWorldGenerator</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">'hello'</span>;	</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">'world'</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'ending'</span>;	<span class="comment">// 以return作为结束执行的标志</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> hw = helloWorldGenerator();</span><br><span class="line">hw.next();	<span class="comment">// 执行后的数据为一个对象：&#123; value: 'hello', done: false &#125;</span></span><br><span class="line">hw.next();	<span class="comment">// &#123; value: 'world', done: false &#125;</span></span><br><span class="line">hw.next();	<span class="comment">// &#123; value: 'ending', done: true &#125;</span></span><br><span class="line">hw.next();	<span class="comment">// &#123; value: undefined, done: true &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 也可以直接return 不必一直调用next() </span></span><br><span class="line">hw.return(<span class="string">'aaa'</span>);	<span class="comment">// &#123; value: 'aaa', done: true &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// yield* fn() 这种用法表示generator的嵌套执行</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Generator可以作为一个暂缓执行函数</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'执行了！'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> generator = f();	<span class="comment">// 如果这里的f()是普通函数，那么这里就执行了f()里面的内容</span></span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  generator.next()</span><br><span class="line">&#125;, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Generator有3个方法 next()  throw()  return()。它们将yield替换成值、throw语句、return语句。next里面传值时会被当做上一个yield的值</p>
</li>
<li><p>Generator轻松遍历所以数组成员</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">iterTree</span>(<span class="params">tree</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(tree)) &#123;	<span class="comment">// 如果是Array</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>; i &lt; tree.length; i++) &#123;</span><br><span class="line">      <span class="keyword">yield</span>* iterTree(tree[i]);	<span class="comment">// 将Array的每一项当参数继续传入函数执行</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;	<span class="comment">// 否则直接返回</span></span><br><span class="line">    <span class="keyword">yield</span> tree;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> tree = [ <span class="string">'a'</span>, [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],<span class="string">'b'</span>, <span class="string">'c'</span>]];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> x <span class="keyword">of</span> iterTree(tree)) &#123;	<span class="comment">// for of 能循环执行yield</span></span><br><span class="line">  <span class="built_in">console</span>.log(x);	<span class="comment">// a 1 2 3 b c</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>Generator实现协程。A B两个方法交替执行完成同一个任务</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">A</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"1"</span>);</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">"B"</span>;<span class="comment">//交由B处理</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"11"</span>);</span><br><span class="line">  <span class="keyword">yield</span> <span class="string">"B"</span>;<span class="comment">//交由B处理</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// B函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">B</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"2"</span>);</span><br><span class="line">   <span class="keyword">yield</span> <span class="string">"A"</span>;<span class="comment">//交由A处理</span></span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"22"</span>);</span><br><span class="line">   <span class="keyword">yield</span> <span class="string">"A"</span>;<span class="comment">//交由A处理</span></span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"222"</span>);<span class="comment">//上菜</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> fnA = A();</span><br><span class="line"><span class="keyword">var</span> fnB = B();</span><br><span class="line"><span class="comment">//流程控制</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">   <span class="keyword">var</span> v = fn.next();</span><br><span class="line">   <span class="keyword">if</span>(v.value ==<span class="string">"A"</span>)&#123;</span><br><span class="line">      run(fnA);	<span class="comment">// 当函数返回值是A 再次进入run 达到循环调用的目的</span></span><br><span class="line">   &#125;<span class="keyword">else</span> <span class="keyword">if</span>(v.value ==<span class="string">"B"</span>)&#123;</span><br><span class="line">      run(fnB);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">run(fnB);<span class="comment">//开始执行 2 1 22 11 222</span></span><br></pre></td></tr></table></figure>

<ul>
<li>生成器本身带有Symbol.iterator。Symbol：唯一标识id，iterator：生成器</li>
</ul>
<h3 id="监听对象属性变化"><a href="#监听对象属性变化" class="headerlink" title="监听对象属性变化"></a>监听对象属性变化</h3><ul>
<li><strong>Object.defineProperty</strong>通过监听对象属性的读取和修改触发函数执行业务代码</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">let</span> obj = &#123;</span><br><span class="line">    _hello:<span class="string">'hello world'</span> <span class="comment">//表示私有变量</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj,<span class="string">'hello'</span>,&#123;</span><br><span class="line">    <span class="keyword">get</span>() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'get'</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._hello;	<span class="comment">// 这里会返回一个值修改obj的hello属性</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span>:function (value) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'set'</span>);</span><br><span class="line">        <span class="keyword">this</span>._hello = value; <span class="comment">// 使得obj的私有属性_hello与hello属性保持一致</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(obj.hello);</span><br><span class="line">obj.hello = <span class="string">'goodbye'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(obj.hello);</span><br></pre></td></tr></table></figure>

<ul>
<li>代理<strong>Proxy</strong>类似于defineProperty的加强版</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">     hello:<span class="string">'hello world'</span></span><br><span class="line"> &#125;;</span><br><span class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</span><br><span class="line">    <span class="keyword">get</span>(target, property) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'get'</span>);</span><br><span class="line">        <span class="keyword">return</span> target[property];</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span>(target,property,value) &#123; <span class="comment">// target当前对象 property属性 value修改的属性值</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'set'</span>);</span><br><span class="line">        target[property] = value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(proxy.hello);</span><br><span class="line">proxy.hello = <span class="string">'goodbye'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(proxy.hello);</span><br></pre></td></tr></table></figure>

<h3 id="async-await的用法"><a href="#async-await的用法" class="headerlink" title="async await的用法"></a>async await的用法</h3><p>async和await配合使用常用来解决回调地狱的问题，可以使代码更简洁</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">takeLongTime</span>(<span class="params"></span>) </span>&#123;	<span class="comment">// 返回一个promise对象</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> resolve(<span class="string">"long_time_value"</span>), <span class="number">1000</span>);<span class="comment">//这里用定时器模拟异步操作</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;		<span class="comment">// async申明的函数本质上是一个promise对象</span></span><br><span class="line">    <span class="keyword">const</span> v = <span class="keyword">await</span> takeLongTime();</span><br><span class="line">    <span class="built_in">console</span>.log(v);	<span class="comment">// 只有等待takeLongTime()执行完才打印信息，在此函数体内就把异步操作变同步了</span></span><br><span class="line">&#125;</span><br><span class="line">test();</span><br></pre></td></tr></table></figure>

<p>异步操作结束-&gt;通知到resolve()函数-&gt;通知到await可以执行下面代码了。用generate生成器也可以做到这一点。</p>
<h3 id="call、apply、bind的区别"><a href="#call、apply、bind的区别" class="headerlink" title="call、apply、bind的区别"></a>call、apply、bind的区别</h3><p>每个函数都包含这3个方法，它们能修改this的指向</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">    user:<span class="string">"Ice"</span>,</span><br><span class="line">    fn:<span class="function"><span class="keyword">function</span>(<span class="params">e,ee</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.user); <span class="comment">//Ice</span></span><br><span class="line">		<span class="built_in">console</span>.log(e+ee);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> b = a.fn; <span class="comment">// 申明变量b继承变量a的一个方法</span></span><br><span class="line">b(<span class="number">1</span>, <span class="number">2</span>);  <span class="comment">// underfined NaN b继承了a的方法但是它的this指向的是全局变量</span></span><br><span class="line">b.call(a,<span class="number">1</span>,<span class="number">2</span>); <span class="comment">// call使b的this指向了a</span></span><br><span class="line">b.apply(a,[<span class="number">1</span>,<span class="number">2</span>]); <span class="comment">// 同上，区别在于传参不同</span></span><br><span class="line">b.bind(a);	<span class="comment">// 这里 bind返回了一个新的函数，这里并不会立即执行</span></span><br></pre></td></tr></table></figure>

<h3 id="for…in和for…of"><a href="#for…in和for…of" class="headerlink" title="for…in和for…of"></a>for…in和for…of</h3><p>for循环相比于用api循环的优点在于可以主动用break结束循环，用return结束函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// for in遍历对象</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">a</span>:<span class="number">1</span>, <span class="attr">b</span>:<span class="number">2</span>, <span class="attr">c</span>:<span class="number">3</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(prop);	<span class="comment">// a b c</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// for in遍历数组</span></span><br><span class="line"><span class="keyword">var</span> obj = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> prop <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(prop);	<span class="comment">// ‘0’ ‘1’ ‘2’ 由此可见for in会自动添加下标</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//for of遍历数组、字符串、Set、Map等</span></span><br><span class="line"><span class="keyword">var</span> a = [&#123;<span class="attr">a</span>:<span class="number">1</span>&#125;, &#123;<span class="attr">b</span>:<span class="number">2</span>&#125;, &#123;<span class="attr">c</span>:<span class="number">3</span>&#125;];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> val <span class="keyword">of</span> a) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(val);	<span class="comment">// &#123;a:1&#125; &#123;b:2&#125; &#123;c:3&#125; 遍历出值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>for…of其实隐式调用了Iterator方法（不断调用iterator.next()）</p>
<p>执行效率：常规for循环 &gt; forEach &gt; for…of  &gt;  map &gt;  for…in</p>
<h3 id="面向对象Class"><a href="#面向对象Class" class="headerlink" title="面向对象Class"></a>面向对象Class</h3><ol>
<li><h5 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h5><ul>
<li><p>构造函数其实就是一个普通的函数。</p>
</li>
<li><p>构造函数的写法：函数体内用this声明一些共有属性，用.prototype来申明共有方法，用new 构造函数()创建一个对象继承构造函数的属性和方法。通过原型的继承，它节约了内存。</p>
</li>
<li><p>js创建对象时都有一个_proto_的内置属性，它指向了构造函数的prototype。构造函数.prototype.constructor又指向构造函数本身</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">   <span class="keyword">this</span>.name = name</span><br><span class="line"> &#125;;</span><br><span class="line">person.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'名字是:'</span>+<span class="keyword">this</span>.name); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> aa = <span class="keyword">new</span> person(<span class="string">'cat'</span>);</span><br><span class="line"><span class="keyword">var</span> bb = <span class="keyword">new</span> person(<span class="string">'dog'</span>)</span><br><span class="line">aa.getName(); 	<span class="comment">//名字是:cat</span></span><br><span class="line">bb.getName();	<span class="comment">//名字是:dog</span></span><br><span class="line"><span class="built_in">console</span>.log(aa.__proto__ === person.prototype);  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(person.prototype.constructor === person);  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><h5 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h5><ul>
<li>用class改造上面的构造函数。实例化一个对象的时候constructor里面的内容会执行一遍。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'constructor执行了'</span>);</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    getName() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'名字是:'</span>+<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> person(<span class="string">'cat'</span>);</span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> person(<span class="string">'dog'</span>);</span><br><span class="line">a.getName();  <span class="comment">//名字是:cat</span></span><br><span class="line">b.getName();  <span class="comment">//名字是:dog</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>class可以通过extends来继承，constructor内使用super()调用父类的构造方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">personA</span> <span class="keyword">extends</span> <span class="title">person</span> </span>&#123;</span><br><span class="line">	<span class="keyword">constructor</span>(name, food) &#123;</span><br><span class="line">		<span class="keyword">super</span>(name);</span><br><span class="line">		<span class="keyword">this</span>.food = food;</span><br><span class="line">	&#125;</span><br><span class="line">	myfood() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'吃东西：'</span>+<span class="keyword">this</span>.food)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> personA(<span class="string">'cat'</span>, <span class="string">'apple'</span>);</span><br><span class="line">a.myfood();</span><br><span class="line">a.getName();</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/10/typescript-practice/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/10/typescript-practice/" itemprop="url">Typescript 最佳实践</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-10T00:00:00+08:00">
                2019-10-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/typescript/" itemprop="url" rel="index">
                    <span itemprop="name">typescript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="不能忽略的options"><a href="#不能忽略的options" class="headerlink" title="不能忽略的options"></a>不能忽略的options</h3><p>聊一下一些默认关闭着的、却又非常影响类型系统的实际效果的选项。下面这些选项，如果你有类型洁癖，都可以开启。若你想得到类型推导系统带来的好处，建议至少开启noImplicitAny和strictNullChecks。<br>若你只想获得编辑器的提示，又不想陷入类型的泥淖中，可以保留默认值。</p>
<ul>
<li>noImplicitAny  当存在不明确的any时报错。</li>
<li>noImplicitThis 当this 无法正确推导时报错</li>
<li>alwaysStrict  在解析时使用严格模式，并且为每个文件增加 “use strict”</li>
<li>strictBindCallApply  对使用bind 、call 和 apply 调用的函数进行严格的检查</li>
<li>strictNullChecks 严格检查可空类型 （对于可以根据上下文逻辑，确定非空的地方，可使用感叹号!来去除类void的类型）。</li>
<li>strictFunctionTypes 严格检查函数的参数 （主要针对参数继承的情况，用的比较少）</li>
<li>strictPropertyInitialization  严格检查非空的类的属性是否都在constructor中进行初始化</li>
<li>strict 开启noImplicitAny、noImplicitThis、alwaysStrict、strictBindCallApply、strictNullChecks、strictFunctionTypes和strictPropertyInitialization。</li>
<li>noImplicitReturns 当不存在明确的return 语句时报错</li>
<li>noUnusedLocals  当存在没有使用的局部变量时报错。</li>
<li>noUnusedParameters  当存在没有使用的函数参数时报错（如果需要占位，可使用下划线_）。</li>
<li>suppressImplicitAnyIndexErrors 对于隐式使用索引类型的地方进行检查</li>
<li>suppressExcessPropertyErrors  是否检查过量的属性（酌情使用，建议开启）</li>
</ul>
<h3 id="副作用-side-effect"><a href="#副作用-side-effect" class="headerlink" title="副作用 side effect"></a>副作用 side effect</h3><p>前端开发始终都在和副作用作斗争。拿到底什么是副作用呢？举一个简单的例子就可以解释清楚了，假如我们写了一段代码，我们本地测试ok，就提交集成测试了，大多数比较正常的请款是测试失败。一般来说，失败的原因集中在，某种特殊的情况下，后端接口的返回与预期不一致。在这个例子中，API调用属于副作用的一种。通常意义上的副作用是，调用函数后，除了函数的返回值之外，还会对主调用函数产生附加影响。</p>
<p>假如我们把整个页面应用看作一个函数，那么他的副作用一般来源于一下几个方面：</p>
<ul>
<li>网络通信（http 调用， ws等）</li>
<li>文件或数据IO（localStorage、IndexedDB、sessionStorage、File等）</li>
<li>用户交互（按钮点击、表单输入、URL改变等）</li>
</ul>
<p>这些副作用时时刻刻在影响我们应用的状态，可以说是Bug的源泉。然而，我们却很少善待这一部分的工作。比如，我们通常喜欢快刀斩乱麻似的定义API的结构、然后进入开发环节；我们不假思索的将数据存储在localStorage确很少关心什么时候删除。</p>
<p>遗憾的是，TS不会帮我们解决这些Bug，但它给我们提供了一个解决这些问题的思路，那就是在有Side Effect的地方定义更为明确的类型，比如：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 一般做法</span></span><br><span class="line"><span class="keyword">const</span> getDataFromStorage = <span class="function">(<span class="params">key: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> str = <span class="built_in">window</span>.localStorage.getItem(key);</span><br><span class="line">  <span class="keyword">return</span> str ? <span class="built_in">JSON</span>.parse(str) : <span class="literal">null</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> someData = getDataFromStorage(<span class="string">"DATA_KEY"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 推荐做法</span></span><br><span class="line"><span class="keyword">interface</span> DataType &#123;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">    age: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDataFromStorage</span>&lt;<span class="title">T</span>&gt;(<span class="params">key: <span class="built_in">string</span></span>): <span class="title">T</span> | <span class="title">null</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> str = <span class="built_in">window</span>.localStorage.getItem(key);</span><br><span class="line">    <span class="keyword">return</span> str ? <span class="built_in">JSON</span>.parse(str) : <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> someData = getDataFromStorage&lt;DataType&gt;(<span class="string">"DATA_KEY"</span>);</span><br></pre></td></tr></table></figure>

<p>这里只列举了localStorage的情况，对于其他副作用，也是同样的。我们可以基于该例子推广到一般处理副作用的函数上，对于这里函数，最好能满足这些特点：</p>
<ul>
<li>明确返回值的可能性，比如对于 getDataFromStorage 的返回值可能是 null 、也可能是 T类型</li>
<li>提供可定制的泛型参数，比如对于getDataFromStorage函数而言，根据key的参数不同，返回值的类型可能不同，这里我们可以用泛型提供这种定制的可能性。</li>
<li>提供明确的泛型类型，比如对于getDataFromStorage函数而言，这里明确了类型是DataType而不是由TS默认推导出的{}类型（在未来的TS版本中，它会被改为unknow类型）</li>
</ul>
<p>如果能够做到这几点，我无法保证项目中的Bug数量会降低一个数量级，但至少会让不清楚API历史的新人踩更少的坑，从而提高团队的效率。</p>
<h3 id="泛型优于联合类型（union-type）"><a href="#泛型优于联合类型（union-type）" class="headerlink" title="泛型优于联合类型（union type）"></a>泛型优于联合类型（union type）</h3><p>联合类型可以说是在ts中最容易被滥用的类型之一。<br>先看一个例子：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Bird &#123;</span><br><span class="line">  fly(): <span class="built_in">void</span>;</span><br><span class="line">  layEggs(): <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> Fish &#123;</span><br><span class="line">  swim(): <span class="built_in">void</span>;</span><br><span class="line">  layEggs(): <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 获得小宠物，这里认为不能够下蛋的宠物是小宠物。现实中的逻辑有点牵强，只是举个例子。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSmallPet</span>(<span class="params">...animals: <span class="built_in">Array</span>&lt;Fish | Bird&gt;</span>): <span class="title">Fish</span> | <span class="title">Bird</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> animal of animals) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!animal.layEggs())</span><br><span class="line">      <span class="keyword">return</span> animal;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> animals[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> pet = getSmallPet();</span><br><span class="line">pet.layEggs(); <span class="comment">// okay 因为layEggs是Fish | Bird 共有的方法</span></span><br><span class="line">pet.swim(); <span class="comment">// errors 因为swim是Fish的方法，而这里可能不存在</span></span><br></pre></td></tr></table></figure>

<p>这个例子存在三个问题：</p>
<ul>
<li>类型定义使getSmallPet变得局限。从代码逻辑看，它的作用是返回一个不下蛋的动物，返回的类型指向的是Fish或Bird。但我如果只想在一群鸟中挑出一个不下蛋的鸟呢？通过调用这个方法，我只能得到一个或者是Fish、或者是Bird的神奇生物。</li>
<li>代码重复、难以扩展。比如，我想再增加一个乌龟。我必须找到所有类似Fish | Bird的地方，然后把它修改为Fish | Bird | Turtle。</li>
<li>类型签名无法提供逻辑相关性。我们再审视一下类型签名，完全无法看出这里为什么是Fish | Bird而不是其它动物，它们两个到底和逻辑有什么关系才能够被放在这里。</li>
</ul>
<p>我们用泛型来解决这个问题：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 将共有的layEggs抽象到Eggable接口</span></span><br><span class="line"><span class="keyword">interface</span> Eggable &#123;</span><br><span class="line">  layEggs(): <span class="built_in">boolean</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> Bird <span class="keyword">extends</span> Eggable &#123;</span><br><span class="line">  fly(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> Fish <span class="keyword">extends</span> Eggable &#123;</span><br><span class="line">  swim(): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用泛型，并用泛型约束声明接收的动物必须是继承了Eggable接口的类型，也展示了这个函数的作用范围是Eggable</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSmallPet</span>&lt;<span class="title">T</span> <span class="title">extends</span> <span class="title">Eggable</span>&gt;(<span class="params">...animals: <span class="built_in">Array</span>&lt;T&gt;</span>): <span class="title">T</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> animal of animals) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!animal.layEggs())</span><br><span class="line">      <span class="keyword">return</span> animal;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> animals[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 可以用于继承了Eggable的任意类型，比如这里想找到鱼里面不能下蛋的鱼也是可以的</span></span><br><span class="line"><span class="keyword">let</span> pet = getSmallPet&lt;Fish&gt;();</span><br><span class="line">pet.layEggs(); <span class="comment">// okay</span></span><br><span class="line">pet.swim(); <span class="comment">// okay</span></span><br></pre></td></tr></table></figure>


<h3 id="巧用typeof优于自定义类型"><a href="#巧用typeof优于自定义类型" class="headerlink" title="巧用typeof优于自定义类型"></a>巧用typeof优于自定义类型</h3><p>在副作用一节，强调了为副作用定义良好类型的重要性。这一节恰好相反，是为了强调在没有副作用的代码中，使用typeof偷懒的重要性。在前端页面，大多数数据来源于服务器，但有少部分数据是写死在前端的。对于这些写死的数据，除本系列第二篇文章提到一种处理手段外，我们有时候还需要这样的类型参与到计算中，这时，可以使用typeof来获取我们想要的类型。</p>
<p>举个例子：<br>比如，我们定义一个URL列表，并且要为类型是通知的标题加上[通知]两个子，代码如下：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">enum</span> URLTypes &#123;</span><br><span class="line">    NORMAL,</span><br><span class="line">    NOTIFICATION</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> urlconfigs = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">type</span>: URLTypes.NORMAL,</span><br><span class="line">        title: <span class="string">"普通页面"</span>,</span><br><span class="line">        component: <span class="string">'div'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">type</span>: URLTypes.NOTIFICATION,</span><br><span class="line">        title: <span class="string">"通知页面"</span>,</span><br><span class="line">        component: <span class="string">'p'</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提取urlconfigs 的类型 ，以便给getTitle函数使用</span></span><br><span class="line"><span class="keyword">type</span> UrlConfigItem = <span class="keyword">typeof</span> urlconfigs[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTitlte</span>(<span class="params">item: UrlConfigItem, title: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(item.type === URLTypes.NOTIFICATION) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`[通知]-<span class="subst">$&#123;title&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> title;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样，我们可以借助于TS，少些一些类型定义。另一个通常能够用到这个技巧的地方是类的函数，有时，我们希望将一个函数的返回值传给另一个函数，而这时我们又不想对函数接收的参数进行重复的类型定义，这种情况下，我们可以使用ReturnType获得函数的返回类型，然后用于另一个函数的参数。</p>
<h3 id="未完待续"><a href="#未完待续" class="headerlink" title="未完待续.."></a>未完待续..</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/09/html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/09/html/" itemprop="url">HTML 书写规范</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-09T00:00:00+08:00">
                2019-10-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/" itemprop="url" rel="index">
                    <span itemprop="name">项目总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><ul>
<li>缩进使用soft tab (4个空格) </li>
<li>嵌套节点应该缩进</li>
<li>在属性上，使用双引号，不要使用单引号</li>
<li>属性名全都小写，用中划线做分隔符</li>
<li>不要在自动闭合标签结尾处使用斜线（<a href="https://html.spec.whatwg.org/multipage/syntax.html#syntax-start-tag" target="_blank" rel="noopener">HTML5规范</a>指出他们是可选的）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;title&gt;Page title&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;&#x2F;head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;img src&#x3D;&quot;images&#x2F;company_logo.png&quot; alt&#x3D;&quot;Company&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;h1 class&#x3D;&quot;hello-world&quot;&gt;Hello, world!&lt;&#x2F;h1&gt;</span><br><span class="line">    &lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="HTML5-doctype"><a href="#HTML5-doctype" class="headerlink" title="HTML5 doctype"></a>HTML5 doctype</h3><p>在页面开头使用这个简单地doctype来启用标准模式，使其在每个浏览器中尽可能一致的展现；</p>
<p>虽然doctype不区分大小写，但是按照惯例，doctype大写 (<a href="https://stackoverflow.com/questions/15594877/is-there-any-benefits-to-use-uppercase-or-lowercase-letters-with-html5-tagname" target="_blank" rel="noopener">关于属性时大写还是小写</a>)</p>
<h3 id="lang属性"><a href="#lang属性" class="headerlink" title="lang属性"></a>lang属性</h3><p>根据HTML5规范：</p>
<blockquote>
<p>应在html标签上加上lang属性。这会给语音工具和翻译工具帮助，告诉它们应当怎么去发音和翻译。</p>
</blockquote>
<p>更多关于 lang 属性的说明 <a href="https://html.spec.whatwg.org/multipage/semantics.html#the-html-element" target="_blank" rel="noopener">在这里</a></p>
<p>在sitepoint上可以查到 <a href="https://www.sitepoint.com/iso-2-letter-language-codes/" target="_blank" rel="noopener">语言列表</a></p>
<p>但sitepoint只是给出了语言的大类，例如中文只给出了zh，但是没有区分香港，台湾，大陆。而微软给出了一份更加详细的<a href="https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/" target="_blank" rel="noopener">语言列表</a>，其中细分了zh-cn, zh-hk, zh-tw。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en-us&quot;&gt;</span><br><span class="line">    ...</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="字符编码"><a href="#字符编码" class="headerlink" title="字符编码"></a>字符编码</h3><p>通过声明一个明确的字符编码，让浏览器轻松、快速的确定适合网页内容的渲染方式，通常指定为’UTF-8’。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;&#x2F;head&gt;</span><br><span class="line">    ...</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="IE兼容模式"><a href="#IE兼容模式" class="headerlink" title="IE兼容模式"></a>IE兼容模式</h3><p>用 <code>meta</code> 标签可以指定页面应该用什么版本的IE来渲染<br>如果你想要了解更多，请点击<a href="https://stackoverflow.com/questions/6771258/what-does-meta-http-equiv-x-ua-compatible-content-ie-edge-do" target="_blank" rel="noopener">这里</a>；</p>
<p>不同doctype在不同浏览器下会触发不同的渲染模式（<a href="https://hsivonen.fi/doctype/" target="_blank" rel="noopener">这篇文章总结的很到位</a>）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;Edge&quot;&gt;</span><br><span class="line">    &lt;&#x2F;head&gt;</span><br><span class="line">    ...</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="viewport"><a href="#viewport" class="headerlink" title="viewport"></a>viewport</h3><p>我们在做响应式布局的时候，肯定要考虑到适配移动端的屏幕，大多数同学也一定复制粘贴过下面这段代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0, maximum-scale&#x3D;1.0, user-scalable&#x3D;0&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>添加了这段代码以后，我们在移动端看到的显示效果就非常好，整个页面不会缩成一团。但是很多时候我们只是拿来用了，没有去理解这段代码究竟干了什么，为什么会影响移动端页面的布局效果，它又是怎么起作用的。<br>这篇<a href="https://www.imooc.com/article/34720" target="_blank" rel="noopener">手记</a>讲明白了，meta 标签viewport 的原理和作用</p>
<h3 id="引入CSS-JS"><a href="#引入CSS-JS" class="headerlink" title="引入CSS, JS"></a>引入CSS, JS</h3><p>根据HTML5规范, 通常在引入CSS和JS时不需要指明 type，因为 text/css和 text/javascript 分别是他们的默认值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- External CSS --&gt;</span><br><span class="line">&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;code_guide.css&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- In-document CSS --&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    ...</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- External JS --&gt;</span><br><span class="line">&lt;script src&#x3D;&quot;code_guide.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- In-document JS --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    ...</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="属性顺序"><a href="#属性顺序" class="headerlink" title="属性顺序"></a>属性顺序</h3><p>属性应该按照特定的顺序出现以保证易读性；</p>
<ul>
<li>class</li>
<li>id</li>
<li>name</li>
<li>data-*</li>
<li>src , for, type, href, value, max-length, max, min, pattern </li>
<li>placeholder, title, alt</li>
<li>aria-*, role</li>
<li>required, readonly, disabled</li>
</ul>
<p>class是为高可复用组件设计的，所以应处在第一位；</p>
<p>id更加具体且应该尽量少使用，所以将它放在第二位。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;a class&#x3D;&quot;...&quot; id&#x3D;&quot;...&quot; data-modal&#x3D;&quot;toggle&quot; href&#x3D;&quot;#&quot;&gt;Example link&lt;&#x2F;a&gt;</span><br><span class="line"></span><br><span class="line">&lt;input class&#x3D;&quot;form-control&quot; type&#x3D;&quot;text&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;img src&#x3D;&quot;...&quot; alt&#x3D;&quot;...&quot;&gt;</span><br></pre></td></tr></table></figure>

<h3 id="JS生成标签"><a href="#JS生成标签" class="headerlink" title="JS生成标签"></a>JS生成标签</h3><p>在JS文件中生成标签让内容变得更难查找，更难编辑，性能更差。应该尽量避免这种情况的出现。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/09/css-BEM/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/09/css-BEM/" itemprop="url">CSS — BEM 命名规范</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-09T00:00:00+08:00">
                2019-10-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/" itemprop="url" rel="index">
                    <span itemprop="name">项目总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="什么是BEM-命名规范"><a href="#什么是BEM-命名规范" class="headerlink" title="什么是BEM 命名规范"></a>什么是BEM 命名规范</h3><ul>
<li><a href="https://en.bem.info/" target="_blank" rel="noopener">Bem</a> 是块（block）、元素（element）、修饰符（modifier）的简写，由 Yandex 团队提出的一种前端 CSS 命名方法论。</li>
</ul>
<blockquote>
<p> -中划线：仅作为连接符使用，表示某个块或者某个子元素的多单词之间的连接记号</p>
</blockquote>
<blockquote>
<p> __ 双下划线：双下划线用来连接块和块的子元素</p>
</blockquote>
<blockquote>
<p>_ 单下划线：单下划线用来描述一个块和一个块或块的子元素的一种状态</p>
</blockquote>
<p>type-block__element_modifier</p>
<h3 id="块（block）"><a href="#块（block）" class="headerlink" title="块（block）"></a>块（block）</h3><p>一个块是设计或布局的一部分，它具有具体且唯一的意义，要么是语义上要么是视觉上<br>在大多数情况下，任何独立的页面元素（或复杂或简单）都可以被视作一个块。它的HTML容器会有一个唯一的CSS类名，也就是这个块的名字。<br>针对块的CSS类名会加一些前缀（ ui-），这些前缀在CSS中有类似 命名空间 的作用</p>
<p>一个块的正式（实际上是半正式的）定义有下面三个基本原则：</p>
<ol>
<li>css中只能使用类名（不能是ID）</li>
<li>每一个块名应该有一个命名空间（前缀）</li>
<li>每一条CSS规则必须属于一个块。</li>
</ol>
<p>例如：一个自定义列表 .list 是一个块，通常自定义列表是算在 module 类别的，在这种情况下，一个 list 列表的block写法应该为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.list</span><br></pre></td></tr></table></figure>

<h3 id="元素（element）"><a href="#元素（element）" class="headerlink" title="元素（element）"></a>元素（element）</h3><p>块中的子元素是块的子元素，并且子元素的子元素在 bem 里也被认为是块的直接子元素。一个块中元素的类名必须用父级块的名称作为前缀。</p>
<p>如上面的例子，li.item 是列表的一个子元素，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 普通写法</span><br><span class="line">.list&#123;&#125;</span><br><span class="line">.list .item&#123;&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; BEM 写法</span><br><span class="line">.list&#123;&#125;</span><br><span class="line">.list__item&#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="修饰符（modifier）"><a href="#修饰符（modifier）" class="headerlink" title="修饰符（modifier）"></a>修饰符（modifier）</h3><p>一个“修饰符”可以理解为一个块的特定状态，标识着它持有一个特定的属性。<br>用一个例子来解释最好不过了。一个表示按钮的块默认有三个大小：小，中，大。为了避免创建三个不同的块，最好是在块上加修饰符。这个修饰符应该有个名字（比如：size ）和值（ small，normal 或者 big ）。<br>如上面的例子中，表示一个选中的列表，和一个激活的列表项</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 普通写法</span><br><span class="line">.list&#123;&#125;</span><br><span class="line">.list.select&#123;&#125;</span><br><span class="line">.list .item&#123;&#125;</span><br><span class="line">.list .item.active&#123;&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; BEM 写法</span><br><span class="line">.list&#123;&#125;</span><br><span class="line">.list_select&#123;&#125;</span><br><span class="line">.list__item&#123;&#125;</span><br><span class="line">.list__item_active&#123;&#125;</span><br></pre></td></tr></table></figure>


<h3 id="LESS-书写规范"><a href="#LESS-书写规范" class="headerlink" title="LESS 书写规范"></a>LESS 书写规范</h3><p>使用 .less 后缀的文件来存储变量、混合代码以及最终合并压缩。  </p>
<table>
<thead>
<tr>
<th align="left">子less</th>
<th align="right">注解</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>lib-base.less</code></td>
<td align="right">预定义的变量，例如颜色、字号、字体</td>
</tr>
<tr>
<td align="left"><code>lib-mixins.less</code></td>
<td align="right">用于混合的代码，例如渐变、半透明的混合</td>
</tr>
<tr>
<td align="left"><code>lib-reset.less</code></td>
<td align="right">初始化</td>
</tr>
<tr>
<td align="left"><code>lib-ui.less</code></td>
<td align="right">颗粒化ui功能</td>
</tr>
<tr>
<td align="left"><code>xxx.less</code></td>
<td align="right">模块样式</td>
</tr>
</tbody></table>
<p>.less 文件的引用顺序会对最终编译的样式的作用域和优先级产生影响，请尽量按照由底层到自定义的顺序来引用。</p>
<h3 id="关于风格"><a href="#关于风格" class="headerlink" title="关于风格"></a>关于风格</h3><h5 id="1-原则上不会出现2层以上选择器嵌套"><a href="#1-原则上不会出现2层以上选择器嵌套" class="headerlink" title="1. 原则上不会出现2层以上选择器嵌套"></a>1. 原则上不会出现2层以上选择器嵌套</h5><p>使用BEM原则，用命名来解耦，所有类名都为一层，增加效率和复用性</p>
<h5 id="2-两层选择器嵌套出现在-mod-xxx-item-current子元素的情况，如下："><a href="#2-两层选择器嵌套出现在-mod-xxx-item-current子元素的情况，如下：" class="headerlink" title="2. 两层选择器嵌套出现在.mod-xxx__item_current子元素的情况，如下："></a>2. 两层选择器嵌套出现在.mod-xxx__item_current子元素的情况，如下：</h5><p>使用推荐的嵌套写法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 常规写法：</span><br><span class="line">.xxx&#123;&#125;</span><br><span class="line">.xxx__item&#123;&#125;</span><br><span class="line">.xxx__item_current&#123;&#125;</span><br><span class="line">&#x2F;&#x2F; 嵌套写法</span><br><span class="line">.xxx__item_current .mod-xxx__link&#123;&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 推荐</span><br><span class="line">.xxx&#123;&#125;</span><br><span class="line">.xxx__item&#123;&#125;</span><br><span class="line">.xxx__item_hightlight&#123;&#125;</span><br><span class="line">.xxx__product-name&#123;&#125;</span><br><span class="line">.xxx__link&#123;&#125;</span><br><span class="line">.xxx__ming-zi-ke-yi-hen-chang&#123;&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 嵌套写法</span><br><span class="line">.xxx__item_current&#123;</span><br><span class="line">    .xxx__link&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对应HTML 结构如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul class&#x3D;&quot;xxx&quot;&gt;</span><br><span class="line">    &lt;li class&#x3D;&quot;xxx__item&quot;&gt;第一项</span><br><span class="line">        &lt;div class&#x3D;&quot;xxx__product-name&quot;&gt;我是名称&lt;&#x2F;div&gt;</span><br><span class="line">        &lt;span class&#x3D;&quot;xxx__ming-zi-ke-yi-hen-chang&quot;&gt;看类名&lt;&#x2F;span&gt;</span><br><span class="line">        &lt;a href&#x3D;&quot;#&quot; class&#x3D;&quot;xxx__link&quot;&gt;我是link&lt;&#x2F;a&gt;</span><br><span class="line">    &lt;li&gt;</span><br><span class="line">    &lt;li class&#x3D;&quot;xxx__item xxx__item_current&quot;&gt;第二项 且 当前选择项</span><br><span class="line">        &lt;div class&#x3D;&quot;xxx__product-name&quot;&gt;我是名称&lt;&#x2F;div&gt;</span><br><span class="line">        &lt;a href&#x3D;&quot;#&quot; class&#x3D;&quot;xxx__item-link&quot;&gt;我是link&lt;&#x2F;a&gt;</span><br><span class="line">    &lt;li&gt;</span><br><span class="line">    &lt;li class&#x3D;&quot;xxx__item xxx__item_hightlight&quot;&gt;第三项 且 特殊高亮</span><br><span class="line">         &lt;div class&#x3D;&quot;xxx__product-name&quot;&gt;我是名称&lt;&#x2F;div&gt;</span><br><span class="line">        &lt;a href&#x3D;&quot;#&quot; class&#x3D;&quot;xxx__item-link&quot;&gt;我是link&lt;&#x2F;a&gt;</span><br><span class="line">    &lt;li&gt;</span><br><span class="line">&lt;&#x2F;ul&gt;</span><br></pre></td></tr></table></figure>


<h3 id="BEM-解决问题"><a href="#BEM-解决问题" class="headerlink" title="BEM 解决问题"></a>BEM 解决问题</h3><p>组件之间的完全解耦，不会造成命名空间的污染，如：.mod-xxx ul li 的写法带来的潜在的嵌套风险。</p>
<h3 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h3><p>BEM 命名会使得 Class 类名变长，但经过 gzip 压缩后这个带宽开销可以忽略不计</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxx__item_hightlight</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/09/vue-share/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/09/vue-share/" itemprop="url">vue开发心得分享</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-09T00:00:00+08:00">
                2019-10-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/vue/" itemprop="url" rel="index">
                    <span itemprop="name">vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="开发心得分享"><a href="#开发心得分享" class="headerlink" title="开发心得分享"></a>开发心得分享</h2><h4 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h4><h6 id="做到不信任"><a href="#做到不信任" class="headerlink" title="做到不信任"></a>做到不信任</h6><ol>
<li><p>对产品不信任（流程、细节）</p>
<ul>
<li>在看原型、流程阶段把自己的疑问或想法都提出来，实际参与编码的人能站在代码层去考虑到一些产品想不到的问题，提前发现问题也是帮自己填坑</li>
</ul>
<ol start="2">
<li>对后端不信任（返回值、内容校验）<ul>
<li>对于后端返回来的值一定要时刻记得判断非空、null判断，一般页面报错就是这么来的，后端说绝对不会是不可信的，百密一疏常有</li>
<li>一般来说提示信息由后端定义，或者前后端约定好，后端只返回错误代码，前端定义代码对应报错文案，避免出现调试类型的提示，这里也需要对报错文案进行空值判断</li>
</ul>
</li>
</ol>
</li>
</ol>
<h4 id="编码封装"><a href="#编码封装" class="headerlink" title="编码封装"></a>编码封装</h4><ol>
<li><p>前端字典，可以很好的保持统一性，B端项目效果显著。碰上某些场景部分字典不可用的状况下，可以封装一个方法，将不可用的值的key传入，返回可用的值的对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设备类型</span></span><br><span class="line">dict_device_type: [</span><br><span class="line">  &#123;</span><br><span class="line">    key: <span class="number">2</span>,</span><br><span class="line">    value: <span class="string">'标准ICE-003'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    key: <span class="number">4</span>,</span><br><span class="line">    value: <span class="string">'迷你ICE-004'</span></span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br><span class="line"><span class="comment">// 使用起来直接复制粘贴，改个名字就行</span></span><br><span class="line">&lt;select v-<span class="keyword">for</span>=<span class="string">"item of dict_device_type"</span>&gt;</span><br><span class="line">  &lt;options label=<span class="string">"item.value"</span> value=<span class="string">"item.key"</span>&gt;&lt;<span class="regexp">/options&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>select&gt;</span><br><span class="line"><span class="comment">// 分页页码配置</span></span><br><span class="line">dict_page_size: [<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>]</span><br><span class="line"><span class="comment">// 要修改分页配置的时候，可以一个地方修改，全局都改，保持统一</span></span><br><span class="line">searchData = &#123;</span><br><span class="line">  pageNum:<span class="number">1</span>,</span><br><span class="line">  pageSize:dict_page_size</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="2">
<li><p>工具类方法的提取</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">const</span> that = Vue.prototype</span><br><span class="line"><span class="comment">// 公用方法管理</span></span><br><span class="line"><span class="keyword">const</span> funs = &#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 清空对象的所有属性的值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    emptyObj(obj) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> obj === <span class="string">'object'</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.keys(obj)) &#123;</span><br><span class="line">                obj[key] = <span class="string">''</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> obj;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 本地存储（持久化）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    setS(k, v, t) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> v === <span class="string">"object"</span>) &#123;</span><br><span class="line">            v = <span class="built_in">JSON</span>.stringify(v);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (t == <span class="string">'session'</span>) &#123;</span><br><span class="line">            <span class="built_in">window</span>.sessionStorage.setItem(k, v);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">window</span>.localStorage.setItem(k, v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">that._fun = fun;</span><br><span class="line"><span class="comment">// 使用的时候直接引入</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'util.js'</span></span><br><span class="line"><span class="keyword">this</span>._fun.setS(<span class="string">'userInfo'</span>,&#123;<span class="attr">name</span>:<span class="string">'张三'</span>,<span class="attr">age</span>:<span class="number">18</span>&#125;)</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="3">
<li><p>ui库的引用，新建一个专门的文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; Button, Divider, Form, message &#125; <span class="keyword">from</span> <span class="string">'ant-design-vue'</span></span><br><span class="line">Vue.use(Button);</span><br><span class="line">Vue.use(Divider);</span><br><span class="line">Vue.use(Form);</span><br><span class="line">Vue.use(message);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局弹窗配置</span></span><br><span class="line">message.config(&#123;</span><br><span class="line">  top: <span class="string">`120px`</span>,</span><br><span class="line">  duration: <span class="number">2</span>,</span><br><span class="line">  maxCount: <span class="number">3</span>,</span><br><span class="line">&#125;);</span><br><span class="line">Vue.prototype.$message = message;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 入口引入：import './config/antDesign'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>表单校验的提取</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义项目中表单的规则</span></span><br><span class="line">addOrderRules: &#123;</span><br><span class="line">  name: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">'请输入活动名称'</span>, <span class="attr">trigger</span>: <span class="string">'blur'</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">min</span>: <span class="number">3</span>, <span class="attr">max</span>: <span class="number">5</span>, <span class="attr">message</span>: <span class="string">'长度在 3 到 5 个字符'</span>, <span class="attr">trigger</span>: <span class="string">'blur'</span> &#125;</span><br><span class="line">  ],</span><br><span class="line">  region: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">'请选择活动区域'</span>, <span class="attr">trigger</span>: <span class="string">'change'</span> &#125;</span><br><span class="line">  ],</span><br><span class="line">  date1: [</span><br><span class="line">    &#123; <span class="attr">type</span>: <span class="string">'date'</span>, <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">'请选择日期'</span>, <span class="attr">trigger</span>: <span class="string">'change'</span> &#125;</span><br><span class="line">  ],</span><br><span class="line">  date2: [</span><br><span class="line">    &#123; <span class="attr">type</span>: <span class="string">'date'</span>, <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">'请选择时间'</span>, <span class="attr">trigger</span>: <span class="string">'change'</span> &#125;</span><br><span class="line">  ],</span><br><span class="line">  type: [</span><br><span class="line">    &#123; <span class="attr">type</span>: <span class="string">'array'</span>, <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">'请至少选择一个活动性质'</span>, <span class="attr">trigger</span>: <span class="string">'change'</span> &#125;</span><br><span class="line">  ],</span><br><span class="line">  resource: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">'请选择活动资源'</span>, <span class="attr">trigger</span>: <span class="string">'change'</span> &#125;</span><br><span class="line">  ],</span><br><span class="line">  desc: [</span><br><span class="line">    &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">'请填写活动形式'</span>, <span class="attr">trigger</span>: <span class="string">'blur'</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line">&lt;el-form :model=<span class="string">"ruleForm"</span> :rules=<span class="string">"addOrderRules"</span> ref=<span class="string">"ruleForm"</span>&gt;&lt;<span class="regexp">/el-form&gt;</span></span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="5">
<li><p>高频率使用的方法挂载到实例上</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 工具类的挂载：Vue.prototype.funs = _funs;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>错误统一处理</p>
<ul>
<li>在拦截器里面对200的业务错误和200以外的网络错误做统一报错处理</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 响应拦截</span></span><br><span class="line">service.interceptors.response.use(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Do something with response data</span></span><br><span class="line">    <span class="keyword">if</span> (response &amp;&amp; response.data.return_code == <span class="string">'02'</span>) &#123;</span><br><span class="line">        that.$message.error(response.data.return_msg || <span class="string">'请求失败'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Do something with response error</span></span><br><span class="line">    <span class="keyword">const</span> errObj = &#123;</span><br><span class="line">        <span class="number">400</span>:<span class="string">'错误请求'</span>,</span><br><span class="line">        <span class="number">401</span>:<span class="string">'未授权，请重新登录'</span>,</span><br><span class="line">        <span class="number">403</span>:<span class="string">'拒绝访问'</span>,</span><br><span class="line">        <span class="number">404</span>:<span class="string">'请求错误，未找到该资源'</span>,</span><br><span class="line">        <span class="number">405</span>:<span class="string">'请求方法未允许'</span>,</span><br><span class="line">        <span class="number">408</span>:<span class="string">'请求超时'</span>,</span><br><span class="line">        <span class="number">500</span>:<span class="string">'服务器出错'</span>,</span><br><span class="line">        <span class="number">501</span>:<span class="string">'网络未实现'</span>,</span><br><span class="line">        <span class="number">502</span>:<span class="string">'网络错误'</span>,</span><br><span class="line">        <span class="number">503</span>:<span class="string">'服务不可用'</span>,</span><br><span class="line">        <span class="number">504</span>:<span class="string">'网络超时'</span>,</span><br><span class="line">        <span class="number">505</span>:<span class="string">'http版本不支持该请求'</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (error &amp;&amp; error.response) &#123;</span><br><span class="line">      that.$message.error(errObj[error.response.status] || <span class="string">`连接错误					<span class="subst">$&#123;error.response.status&#125;</span>`</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        that.$message.error(<span class="string">'连接到服务器失败'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h4 id="细节"><a href="#细节" class="headerlink" title="细节"></a>细节</h4><ol>
<li><p>for循环性能</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//github.com/jawil/blog/issues/2</span></span><br><span class="line">循环类型	耗费时间(ms)</span><br><span class="line"><span class="keyword">for</span>	约<span class="number">11.998</span></span><br><span class="line"><span class="keyword">for</span> cache	约<span class="number">10.866</span></span><br><span class="line"><span class="keyword">for</span> 倒序	约<span class="number">11.230</span></span><br><span class="line">forEach	约<span class="number">400.245</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">in</span>	约<span class="number">2930.118</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">of</span>	约<span class="number">320.921</span></span><br><span class="line">正常推荐原始的<span class="keyword">for</span>循环</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">in</span> 一般是用在对象属性名的遍历上的，由于每次迭代操作会同时搜索实例本身的属性以及原型链上的属性，所以效率低下</span><br></pre></td></tr></table></figure>
</li>
<li><p>原始for循环</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 保存数组的length长度</span></span><br><span class="line"><span class="keyword">let</span> len = arr.length</span><br><span class="line">不要在<span class="keyword">for</span>里面直接写</span><br><span class="line">i &lt; arr.length,这样每次循环都会去获取数组的length</span><br></pre></td></tr></table></figure>
</li>
<li><p>一次性函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sca = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'msg'</span>)</span><br><span class="line">    sca = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'new-msg'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">sca() <span class="comment">// msg</span></span><br><span class="line">sca() <span class="comment">// new-msg</span></span><br><span class="line">sca() <span class="comment">// new-msg</span></span><br></pre></td></tr></table></figure>





</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20archive">
              
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count"></span>
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
